"use strict";(self["webpackChunkfitoagro_backoffice"]=self["webpackChunkfitoagro_backoffice"]||[]).push([[265],{3018:function(e,a,t){t.r(a),t.d(a,{default:function(){return Ae}});var l=t(6768),o=t(6450);function r(e,a,t,r,n,i){const s=(0,l.g2)("navigation-drawer"),d=(0,l.g2)("app-bar"),u=(0,l.g2)("core-view");return(0,l.uX)(),(0,l.Wv)(o.E,null,{default:(0,l.k6)((()=>[(0,l.bF)(s),(0,l.bF)(d),(0,l.bF)(u)])),_:1})}var n=t(4232),i=t(9262),s=t(4663),d=t(4587),u=t(1247),c=t(4600);const p=(0,d.j)({text:String,...(0,i.u)(),...(0,s.X)()},"VToolbarTitle"),m=(0,u.RW)()({name:"VToolbarTitle",props:p(),setup(e,a){let{slots:t}=a;return(0,c.C)((()=>{const a=!!(t.default||t.text||e.text);return(0,l.bF)(e.tag,{class:["v-toolbar-title",e.class],style:e.style},{default:()=>[a&&(0,l.bF)("div",{class:"v-toolbar-title__placeholder"},[t.text?t.text():e.text,t.default?.()])]})})),{}}});var v=t(9562),g=t(7852),h=t(5126),b=t(9923),f=t(2886),w=t(2858),y=t(7018),k=t(5296),_=t(3240),F=t(7664),S=t(144),V=t(9094);const C=[null,"prominent","default","comfortable","compact"],W=(0,d.j)({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:e=>C.includes(e)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...(0,b.r)(),...(0,i.u)(),...(0,y.s)(),...(0,_.S)(),...(0,s.X)({tag:"header"}),...(0,F.yx)()},"VToolbar"),x=(0,u.RW)()({name:"VToolbar",props:W(),setup(e,a){let{slots:t}=a;const{backgroundColorClasses:o,backgroundColorStyles:r}=(0,f.z6)((0,S.lW)(e,"color")),{borderClasses:n}=(0,b.M)(e),{elevationClasses:i}=(0,y.j)(e),{roundedClasses:s}=(0,_.v)(e),{themeClasses:d}=(0,F.NX)(e),{rtlClasses:u}=(0,k.IA)(),p=(0,S.IJ)(!(!e.extended&&!t.extension?.())),C=(0,l.EW)((()=>parseInt(Number(e.height)+("prominent"===e.density?Number(e.height):0)-("comfortable"===e.density?8:0)-("compact"===e.density?16:0),10))),W=(0,l.EW)((()=>p.value?parseInt(Number(e.extensionHeight)+("prominent"===e.density?Number(e.extensionHeight):0)-("comfortable"===e.density?4:0)-("compact"===e.density?8:0),10):0));return(0,w.Uh)({VBtn:{variant:"text"}}),(0,c.C)((()=>{const a=!(!e.title&&!t.title),c=!(!t.image&&!e.image),b=t.extension?.();return p.value=!(!e.extended&&!b),(0,l.bF)(e.tag,{class:["v-toolbar",{"v-toolbar--absolute":e.absolute,"v-toolbar--collapse":e.collapse,"v-toolbar--flat":e.flat,"v-toolbar--floating":e.floating,[`v-toolbar--density-${e.density}`]:!0},o.value,n.value,i.value,s.value,d.value,u.value,e.class],style:[r.value,e.style]},{default:()=>[c&&(0,l.bF)("div",{key:"image",class:"v-toolbar__image"},[t.image?(0,l.bF)(g.K,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},t.image):(0,l.bF)(h.y,{key:"image-img",cover:!0,src:e.image},null)]),(0,l.bF)(g.K,{defaults:{VTabs:{height:(0,V.Dg)(C.value)}}},{default:()=>[(0,l.bF)("div",{class:"v-toolbar__content",style:{height:(0,V.Dg)(C.value)}},[t.prepend&&(0,l.bF)("div",{class:"v-toolbar__prepend"},[t.prepend?.()]),a&&(0,l.bF)(m,{key:"title",text:e.title},{text:t.title}),t.default?.(),t.append&&(0,l.bF)("div",{class:"v-toolbar__append"},[t.append?.()])])]}),(0,l.bF)(g.K,{defaults:{VTabs:{height:(0,V.Dg)(W.value)}}},{default:()=>[(0,l.bF)(v.Qo,null,{default:()=>[p.value&&(0,l.bF)("div",{class:"v-toolbar__extension",style:{height:(0,V.Dg)(W.value)}},[b])]})]})]})})),{contentHeight:C,extensionHeight:W}}});var A=t(6984),D=t(2067),I=t(7354);const B=(0,d.j)({scrollTarget:{type:String},scrollThreshold:{type:[String,Number],default:300}},"scroll");function E(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{canScroll:t}=a;let o=0,r=0;const n=(0,S.KR)(null),i=(0,S.IJ)(0),s=(0,S.IJ)(0),d=(0,S.IJ)(0),u=(0,S.IJ)(!1),c=(0,S.IJ)(!1),p=(0,l.EW)((()=>Number(e.scrollThreshold))),m=(0,l.EW)((()=>(0,V.qE)((p.value-i.value)/p.value||0))),v=()=>{const e=n.value;if(!e||t&&!t.value)return;o=i.value,i.value="window"in e?e.pageYOffset:e.scrollTop;const a=e instanceof Window?document.documentElement.scrollHeight:e.scrollHeight;r===a?(c.value=i.value<o,d.value=Math.abs(i.value-p.value)):r=a};return(0,l.wB)(c,(()=>{s.value=s.value||i.value})),(0,l.wB)(u,(()=>{s.value=0})),(0,l.sV)((()=>{(0,l.wB)((()=>e.scrollTarget),(e=>{const a=e?document.querySelector(e):window;a?a!==n.value&&(n.value?.removeEventListener("scroll",v),n.value=a,n.value.addEventListener("scroll",v,{passive:!0})):(0,I.OP)(`Unable to locate element with identifier ${e}`)}),{immediate:!0})})),(0,l.xo)((()=>{n.value?.removeEventListener("scroll",v)})),t&&(0,l.wB)(t,v,{immediate:!0}),{scrollThreshold:p,currentScroll:i,currentThreshold:d,isScrollActive:u,scrollRatio:m,isScrollingUp:c,savedScroll:s}}var T=t(6747),L=t(1743);const H=(0,d.j)({scrollBehavior:String,modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...W(),...(0,A.CK)(),...B(),height:{type:[Number,String],default:64}},"VAppBar"),N=(0,u.RW)()({name:"VAppBar",props:H(),emits:{"update:modelValue":e=>!0},setup(e,a){let{slots:t}=a;const o=(0,S.KR)(),r=(0,D.q)(e,"modelValue"),n=(0,l.EW)((()=>{const a=new Set(e.scrollBehavior?.split(" ")??[]);return{hide:a.has("hide"),fullyHide:a.has("fully-hide"),inverted:a.has("inverted"),collapse:a.has("collapse"),elevate:a.has("elevate"),fadeImage:a.has("fade-image")}})),i=(0,l.EW)((()=>{const e=n.value;return e.hide||e.fullyHide||e.inverted||e.collapse||e.elevate||e.fadeImage||!r.value})),{currentScroll:s,scrollThreshold:d,isScrollingUp:u,scrollRatio:p}=E(e,{canScroll:i}),m=(0,l.EW)((()=>n.value.hide||n.value.fullyHide)),v=(0,l.EW)((()=>e.collapse||n.value.collapse&&(n.value.inverted?p.value>0:0===p.value))),g=(0,l.EW)((()=>e.flat||n.value.fullyHide&&!r.value||n.value.elevate&&(n.value.inverted?s.value>0:0===s.value))),h=(0,l.EW)((()=>n.value.fadeImage?n.value.inverted?1-p.value:p.value:void 0)),b=(0,l.EW)((()=>{const a=Number(o.value?.contentHeight??e.height),t=Number(o.value?.extensionHeight??0);return m.value?s.value<d.value||n.value.fullyHide?a+t:a:a+t}));(0,L.Y)((0,l.EW)((()=>!!e.scrollBehavior)),(()=>{(0,l.nT)((()=>{m.value?n.value.inverted?r.value=s.value>d.value:r.value=u.value||s.value<d.value:r.value=!0}))}));const{ssrBootStyles:f}=(0,T.K)(),{layoutItemStyles:w,layoutIsReady:y}=(0,A.hc)({id:e.name,order:(0,l.EW)((()=>parseInt(e.order,10))),position:(0,S.lW)(e,"location"),layoutSize:b,elementSize:(0,S.IJ)(void 0),active:r,absolute:(0,S.lW)(e,"absolute")});return(0,c.C)((()=>{const a=x.filterProps(e);return(0,l.bF)(x,(0,l.v6)({ref:o,class:["v-app-bar",{"v-app-bar--bottom":"bottom"===e.location},e.class],style:[{...w.value,"--v-toolbar-image-opacity":h.value,height:void 0,...f.value},e.style]},a,{collapse:v.value,flat:g.value}),t)})),y}}),P=(0,u.RW)()({name:"VAppBarTitle",props:p(),setup(e,a){let{slots:t}=a;return(0,c.C)((()=>(0,l.bF)(m,(0,l.v6)(e,{class:"v-app-bar-title"}),t))),{}}});var X=t(2807),O=t(4593),U=t(5523),z=t(7511),R=t(7254),K=t(2164),q=t(8249);function J(e,a,t,o,r,i){const s=(0,l.g2)("ChangePassword"),d=(0,l.g2)("AgentDetail");return(0,l.uX)(),(0,l.Wv)(N,{absolute:"",flat:"",height:"75"},{prepend:(0,l.k6)((()=>[(0,l.bF)(X.D,{class:"mr-3",elevation:"1",color:"secondary",size:"small",onClick:a[0]||(a[0]=e=>i.setDrawer()),icon:i.icon},null,8,["icon"])])),append:(0,l.k6)((()=>[(0,l.bF)(q.q,{modelValue:r.menu,"onUpdate:modelValue":a[2]||(a[2]=e=>r.menu=e),"close-on-content-click":!1,location:"bottom"},{activator:(0,l.k6)((({props:e})=>[(0,l.bF)(X.D,(0,l.v6)(e,{variant:"plain","append-icon":"mdi-dots-vertical"}),{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(i.me?.username),1)])),_:2},1040)])),default:(0,l.k6)((()=>[(0,l.bF)(O.J,{width:"auto"},{default:(0,l.k6)((()=>[(0,l.bF)(R.g,{title:i.me?.username},{append:(0,l.k6)((()=>[(0,l.bF)(U.x,{class:"ml-2",size:"small",color:i.roleColor(i.me?.role),variant:"flat"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(i.me?.role),1)])),_:1},8,["color"])])),_:1},8,["title"]),(0,l.bF)(z.G),(0,l.bF)(K.x8,{nav:"",dense:""},{default:(0,l.k6)((()=>[(0,l.bF)(R.g,{"prepend-icon":"mdi-account-outline",onClick:i.openDetail},{default:(0,l.k6)((()=>[(0,l.eW)(" Conta")])),_:1},8,["onClick"]),(0,l.bF)(s,{agent_id:i.me?.id},null,8,["agent_id"]),(0,l.bF)(R.g,{"prepend-icon":"mdi-logout",onClick:a[1]||(a[1]=e=>i.logout())},{default:(0,l.k6)((()=>[(0,l.eW)("Sair")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),default:(0,l.k6)((()=>[(0,l.bF)(P,{class:"hidden-sm-and-down font-weight-light"},{default:(0,l.k6)((()=>[(0,l.Lk)("strong",null,(0,n.v_)(e.$route.name),1)])),_:1}),(0,l.bF)(d,{me:i.me?.id,editMode:!0,dialog:r.detailDialog,"onUpdate:dialog":a[3]||(a[3]=e=>r.detailDialog=e)},null,8,["me","dialog"])])),_:1})}t(4114);var M=t(5040),j=t(1606),$=t(697),G=t(3745),Y=t(1772),Q=t(1560),Z=t(6756),ee=t(5526),ae=t(9669),te=t(3948);const le=(0,l.Lk)("span",null,"Mudar password",-1);function oe(e,a,t,o,r,n){return(0,l.uX)(),(0,l.Wv)(Y.p,{modelValue:r.dialog,"onUpdate:modelValue":a[9]||(a[9]=e=>r.dialog=e),onAfterLeave:a[10]||(a[10]=e=>n.reset()),persistent:"",width:"auto"},{activator:(0,l.k6)((({props:e})=>[(0,l.bF)(R.g,(0,l.v6)({"prepend-icon":"mdi-key-variant"},e),{default:(0,l.k6)((()=>[(0,l.eW)("Mudar password")])),_:2},1040)])),default:(0,l.k6)((({})=>[(0,l.bF)(O.J,{width:"500"},{default:(0,l.k6)((()=>[(0,l.bF)(j.r,{class:"bg-warning d-flex align-center"},{default:(0,l.k6)((()=>[(0,l.bF)(ae.w,{size:"small",class:"mr-2"},{default:(0,l.k6)((()=>[(0,l.eW)("mdi-key-variant")])),_:1}),le])),_:1}),(0,l.bF)($.O,null,{default:(0,l.k6)((()=>[(0,l.bF)(Z.L,{class:"mt-2",justify:"center"},{default:(0,l.k6)((()=>[(0,l.bF)(ee.B,{cols:"10"},{default:(0,l.k6)((()=>[(0,l.bF)(Q.n,{modelValue:r.formValid,"onUpdate:modelValue":a[6]||(a[6]=e=>r.formValid=e)},{default:(0,l.k6)((()=>[(0,l.bF)(Z.L,null,{default:(0,l.k6)((()=>[(0,l.bF)(ee.B,{cols:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(te.W,{modelValue:r.old_password,"onUpdate:modelValue":a[0]||(a[0]=e=>r.old_password=e),rules:[r.rules.required,r.rules.maxLength],"append-inner-icon":r.oldVisible?"mdi-eye-off":"mdi-eye",type:r.oldVisible?"text":"password",label:"Senha Atual",placeholder:"Insira a senha atual","prepend-inner-icon":"mdi-lock",color:"secondary",density:"compact",variant:"outlined","onClick:appendInner":a[1]||(a[1]=e=>r.oldVisible=!r.oldVisible)},null,8,["modelValue","rules","append-inner-icon","type"])])),_:1}),(0,l.bF)(ee.B,{cols:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(te.W,{modelValue:r.new_password,"onUpdate:modelValue":a[2]||(a[2]=e=>r.new_password=e),rules:[r.rules.required,r.rules.maxLength],"append-inner-icon":r.newVisible?"mdi-eye-off":"mdi-eye",type:r.newVisible?"text":"password",label:"Nova Senha",placeholder:"Insira a nova senha","prepend-inner-icon":"mdi-lock-plus",color:"secondary",density:"compact",variant:"outlined","onClick:appendInner":a[3]||(a[3]=e=>r.newVisible=!r.newVisible)},null,8,["modelValue","rules","append-inner-icon","type"])])),_:1}),(0,l.bF)(ee.B,{cols:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(te.W,{modelValue:r.confirm_password,"onUpdate:modelValue":a[4]||(a[4]=e=>r.confirm_password=e),rules:[r.rules.required,r.rules.maxLength],"append-inner-icon":r.confirmVisible?"mdi-eye-off":"mdi-eye",type:r.confirmVisible?"text":"password",label:"Confirmar Senha",placeholder:"Confirme a nova senha","prepend-inner-icon":"mdi-lock-check",color:"secondary",density:"compact",variant:"outlined","onClick:appendInner":a[5]||(a[5]=e=>r.confirmVisible=!r.confirmVisible)},null,8,["modelValue","rules","append-inner-icon","type"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,l.bF)(z.G),(0,l.bF)(G.S,{class:"d-flex justify-space-around"},{default:(0,l.k6)((()=>[(0,l.bF)(X.D,{color:"error",variant:"tonal",icon:"mdi-close",onClick:a[7]||(a[7]=e=>r.dialog=!1)}),(0,l.bF)(X.D,{color:"secondary",variant:"tonal",icon:"mdi-check",loading:r.isLoading,disabled:!r.formValid,onClick:a[8]||(a[8]=e=>n.postChangePassword())},null,8,["loading","disabled"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var re=t(6044),ne=t(501),ie=t(8355),se={name:"ChangePassword",props:{agent_id:{type:Number,required:!0}},setup(){const e=(0,re.E)(),a=(0,ne.T)();return{accountStore:e,generalStore:a}},data(){return{dialog:!1,isLoading:!1,old_password:"",new_password:"",confirm_password:"",rules:{required:e=>!!e||"Campo obrigatório",maxLength:e=>e.length<=40||"Máximo de 40 caracteres",passwordMatch:e=>e===this.new_password||"Passwords não coincidem"},formValid:!1,oldVisible:!1,newVisible:!1,confirmVisible:!1}},watch:{dialog(e){e&&this.onOpenDialog()}},methods:{onOpenDialog(){},reset(){this.old_password="",this.new_password="",this.confirm_password=""},async postChangePassword(){this.new_password===this.confirm_password?(this.isLoading=!0,await ie.A.request({url:"/api/agents/change_password",method:"patch",headers:{Authorization:`Bearer ${this.accountStore.account.token}`},data:{old_password:this.old_password,new_password:this.new_password}}).then((()=>{this.isLoading=!1,this.dialog=!1,this.generalStore.successSnackbar("Password alterada com sucesso")})).catch((e=>{this.isLoading=!1,this.generalStore.errorSnackbar(e.response.data.error)}))):this.generalStore.errorSnackbar("Passwords não coincidem")}}},de=t(1241);const ue=(0,de.A)(se,[["render",oe]]);var ce=ue,pe={name:"AppBar",components:{AgentDetail:M.A,ChangePassword:ce},setup(){const e=(0,ne.T)(),a=(0,re.E)();return{generalStore:e,accountStore:a}},data(){return{menu:!1,detailDialog:!1}},computed:{icon(){let e=this.generalStore.navDrawerOpen;return e?"mdi-arrow-collapse-left":"mdi-arrow-expand-right"},me(){return this.accountStore.getAccount()}},methods:{openDetail(){this.detailDialog=!0},logout(){this.accountStore.resetAccount(),this.$router.push("/login")},setDrawer(){let e=this.generalStore.navDrawerOpen;this.generalStore.navDrawerOpen=!e},roleColor(e){switch(e){case"Administrador":return"error";case"Organização":return"warning";case"Produtor":return"success";case"Agente de Campo":return"info";default:return"primary"}}}};const me=(0,de.A)(pe,[["render",J]]);var ve=me,ge=t(8477);function he(e,a,t,o,r,n){const i=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.Wv)(ge.Y,null,{default:(0,l.k6)((()=>[(0,l.bF)(i)])),_:1})}var be={};const fe=(0,de.A)(be,[["render",he]]);var we=fe,ye=t(3835),ke=t(4529),_e=t(373);function Fe(e,a,t,o,r,i){return(0,l.uX)(),(0,l.Wv)(_e.e,{modelValue:o.generalStore.navDrawerOpen,"onUpdate:modelValue":a[0]||(a[0]=e=>o.generalStore.navDrawerOpen=e),color:"primary"},{default:(0,l.k6)((()=>[(0,l.bF)(R.g,{onClick:i.goHome},{default:(0,l.k6)((()=>[(0,l.bF)(h.y,{src:ye,class:"ma-2",height:"5rem"})])),_:1},8,["onClick"]),(0,l.bF)(z.G),(0,l.bF)(K.x8,{nav:"",dense:""},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.navItems,(e=>((0,l.uX)(),(0,l.CE)(l.FK,null,[e.children?((0,l.uX)(),(0,l.Wv)(ke.K,{key:1,"prepend-icon":e.icon},{activator:(0,l.k6)((({props:a})=>[(0,l.bF)(R.g,(0,n._B)((0,l.Ng)(a)),{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.title),1)])),_:2},1040)])),default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.children,(e=>((0,l.uX)(),(0,l.Wv)(R.g,{key:e.title,"prepend-icon":e.icon,to:e.to,exact:""},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.title),1)])),_:2},1032,["prepend-icon","to"])))),128))])),_:2},1032,["prepend-icon"])):((0,l.uX)(),(0,l.Wv)(R.g,{key:e.title,"prepend-icon":e.icon,to:e.to,exact:""},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.title),1)])),_:2},1032,["prepend-icon","to"]))],64)))),256))])),_:1})])),_:1},8,["modelValue"])}var Se={setup(){const e=(0,ne.T)(),a=(0,re.E)();return{generalStore:e,accountStore:a}},data(){return{drawer:!0}},computed:{navItems(){let e=[{title:"Meteorologia",icon:"mdi-weather-partly-cloudy",children:[{title:"Estações",icon:"mdi-tower-fire",to:"/weather_stations"}]},{title:"Parcelas",icon:"mdi-land-plots-marker",to:"/regions"},{title:"Períodos",icon:"mdi-calendar-multiple",to:"/periods"},{title:"Organizações",icon:"mdi-domain",to:"/organizations"}];return this.accountStore.hasRole(["Administrador","Agente de Campo"])&&(e.push({title:"Visitas",icon:"mdi-walk",to:"/visits"}),e.push({title:"Protocolos",icon:"mdi-file-document",to:"/protocols"})),this.accountStore.hasRole(["Administrador","Organização"])&&e.push({title:"Utilizadores",icon:"mdi-account-group",to:"/users"}),this.accountStore.hasRole(["Administrador"])&&(e[0].children.push({title:"Fornecedores",icon:"mdi-account-group",to:"/providers"}),e.push({title:"Sistema",icon:"mdi-cogs",to:"/system"})),e}},methods:{goHome(){this.$router.push("/")},logout(){this.accountStore.resetAccount(),this.$router.push("/login")}}};const Ve=(0,de.A)(Se,[["render",Fe]]);var Ce=Ve,We={name:"DashboardIndex",components:{AppBar:ve,CoreView:we,NavigationDrawer:Ce}};const xe=(0,de.A)(We,[["render",r]]);var Ae=xe},3835:function(e,a,t){e.exports=t.p+"img/fitoagro_logo.616834f3.png"}}]);
//# sourceMappingURL=Index.e5dddda1.js.map