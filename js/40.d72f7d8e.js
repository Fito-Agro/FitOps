"use strict";(self["webpackChunkfitoagro_backoffice"]=self["webpackChunkfitoagro_backoffice"]||[]).push([[40],{5040:function(e,a,t){t.d(a,{A:function(){return S}});var l=t(6768),n=t(4232),o=t(2807),i=t(4593),r=t(1606),d=t(697),s=t(3745),u=t(5523),c=t(1772),m=t(7511),g=t(1560),h=t(6756),p=t(5526),v=t(9669),y=t(6106),F=t(594),b=t(3948);const f={key:0},k={class:"font-weight-light"},_={key:1},V={class:"font-weight-light"};function w(e,a,t,w,M,C){return(0,l.uX)(),(0,l.Wv)(c.p,{modelValue:C.localDialog,"onUpdate:modelValue":a[11]||(a[11]=e=>C.localDialog=e),onAfterLeave:a[12]||(a[12]=e=>C.reset()),persistent:t.editMode,width:"auto"},{default:(0,l.k6)((()=>[M.isLoadingDetail?((0,l.uX)(),(0,l.Wv)(y.x,{key:0,color:"secondary",size:"65",indeterminate:""})):((0,l.uX)(),(0,l.Wv)(i.J,{key:1,width:"40rem"},{default:(0,l.k6)((()=>[C.itsMe?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(r.r,{key:0,class:(0,n.C4)(["bg-info d-flex align-center justify-space-between",{"bg-warning":t.editMode}])},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,[t.editMode?((0,l.uX)(),(0,l.CE)("div",f,[(0,l.bF)(v.w,{size:"small",class:"mr-2"},{default:(0,l.k6)((()=>[(0,l.eW)("mdi-pencil")])),_:1}),(0,l.Lk)("span",null,[(0,l.eW)(" Editar Conta "),(0,l.Lk)("span",k,(0,n.v_)(t.agent.username),1)])])):((0,l.uX)(),(0,l.CE)("div",_,[(0,l.bF)(v.w,{size:"small",class:"mr-2"},{default:(0,l.k6)((()=>[(0,l.eW)("mdi-information-outline")])),_:1}),(0,l.Lk)("span",null,[(0,l.eW)(" Detalhes da Conta "),(0,l.Lk)("span",V,(0,n.v_)(t.agent.username),1)])]))]),(0,l.Lk)("div",null,[t.agent.organization?((0,l.uX)(),(0,l.Wv)(u.x,{key:0,class:"mr-2",variant:"tonal",color:"warning"},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(t.agent.organization.organization_name),1)])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(u.x,{label:"",variant:"flat",color:C.roleColor(t.agent.type)},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(t.agent.type),1)])),_:1},8,["color"])])])),_:1},8,["class"])),(0,l.bF)(d.O,null,{default:(0,l.k6)((()=>[(0,l.bF)(g.n,{modelValue:M.agentForm.valid,"onUpdate:modelValue":a[8]||(a[8]=e=>M.agentForm.valid=e)},{default:(0,l.k6)((()=>[(0,l.bF)(h.L,{class:"mt-2"},{default:(0,l.k6)((()=>[(0,l.bF)(p.B,{cols:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(b.W,{modelValue:M.agentForm.agent.name,"onUpdate:modelValue":a[0]||(a[0]=e=>M.agentForm.agent.name=e),modelModifiers:{trim:!0},label:"Nome",placeholder:"Insira o nome","prepend-inner-icon":"mdi-account",color:"secondary",density:"compact",variant:"outlined",readonly:!t.editMode,rules:[M.agentForm.rules.required,M.agentForm.rules.maxLength1]},null,8,["modelValue","readonly","rules"])])),_:1}),(0,l.bF)(p.B,{cols:"7"},{default:(0,l.k6)((()=>[(0,l.bF)(b.W,{modelValue:M.agentForm.agent.address,"onUpdate:modelValue":a[1]||(a[1]=e=>M.agentForm.agent.address=e),modelModifiers:{trim:!0},label:"Morada",placeholder:"Insira a morada","prepend-inner-icon":"mdi-map-marker",color:"secondary",density:"compact",variant:"outlined",readonly:!t.editMode,rules:[M.agentForm.rules.required,M.agentForm.rules.maxLength2]},null,8,["modelValue","readonly","rules"])])),_:1}),(0,l.bF)(p.B,{cols:"5"},{default:(0,l.k6)((()=>[(0,l.bF)(b.W,{modelValue:M.agentForm.agent.city,"onUpdate:modelValue":a[2]||(a[2]=e=>M.agentForm.agent.city=e),modelModifiers:{trim:!0},label:"Cidade",placeholder:"Insira a cidade","prepend-inner-icon":"mdi-city",color:"secondary",density:"compact",variant:"outlined",readonly:!t.editMode,rules:[M.agentForm.rules.required,M.agentForm.rules.maxLength1]},null,8,["modelValue","readonly","rules"])])),_:1}),!t.editMode||C.itsMe?((0,l.uX)(),(0,l.Wv)(p.B,{key:0,cols:"7"},{default:(0,l.k6)((()=>[(0,l.bF)(b.W,{modelValue:M.agentForm.agent.email,"onUpdate:modelValue":a[3]||(a[3]=e=>M.agentForm.agent.email=e),modelModifiers:{trim:!0},label:"Email","prepend-inner-icon":"mdi-email",color:"secondary",density:"compact",variant:"outlined",readonly:"",disabled:C.itsMe,rules:[M.agentForm.rules.required,M.agentForm.rules.email]},null,8,["modelValue","disabled","rules"])])),_:1})):(0,l.Q3)("",!0),!t.editMode||C.itsMe?((0,l.uX)(),(0,l.Wv)(p.B,{key:1,cols:"5"},{default:(0,l.k6)((()=>[(0,l.bF)(b.W,{modelValue:M.agentForm.agent.phone,"onUpdate:modelValue":a[4]||(a[4]=e=>M.agentForm.agent.phone=e),modelModifiers:{trim:!0},label:"Telefone","prepend-inner-icon":"mdi-phone",prefix:"+351",counter:"9",color:"secondary",density:"compact",variant:"outlined",readonly:"",disabled:C.itsMe,rules:[M.agentForm.rules.required,M.agentForm.rules.phone]},null,8,["modelValue","disabled","rules"])])),_:1})):(0,l.Q3)("",!0),C.itsMe?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(p.B,{key:2,cols:"12",class:"d-flex align-center justify-space-around"},{default:(0,l.k6)((()=>[(0,l.bF)(F.N,{modelValue:M.agentForm.agent.accepted,"onUpdate:modelValue":a[5]||(a[5]=e=>M.agentForm.agent.accepted=e),color:"secondary",label:"Aceite",readonly:!t.editMode},null,8,["modelValue","readonly"]),(0,l.bF)(F.N,{modelValue:M.agentForm.agent.blocked,"onUpdate:modelValue":a[6]||(a[6]=e=>M.agentForm.agent.blocked=e),color:"secondary",label:"Bloqueado",readonly:!t.editMode},null,8,["modelValue","readonly"]),(0,l.bF)(F.N,{modelValue:M.agentForm.agent.active,"onUpdate:modelValue":a[7]||(a[7]=e=>M.agentForm.agent.active=e),color:"secondary",label:"Ativo",readonly:!t.editMode},null,8,["modelValue","readonly"])])),_:1}))])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,l.bF)(m.G),t.editMode?((0,l.uX)(),(0,l.Wv)(s.S,{key:1,class:"d-flex justify-space-around"},{default:(0,l.k6)((()=>[(0,l.bF)(o.D,{color:"error",variant:"tonal",icon:"mdi-close",onClick:a[9]||(a[9]=e=>C.localDialog=!1)}),(0,l.bF)(o.D,{color:"secondary",variant:"tonal",icon:"mdi-check",loading:M.isLoading,disabled:!M.agentForm.valid,onClick:a[10]||(a[10]=e=>C.editAgent())},null,8,["loading","disabled"])])),_:1})):(0,l.Q3)("",!0)])),_:1}))])),_:1},8,["modelValue","persistent"])}var M=t(6044),C=t(501),D=t(8355),L={name:"AgentDetail",props:{agent:{type:Object},me:{type:Number,required:!1,default:null},editMode:{type:Boolean,required:!1,default:!1},dialog:{type:Boolean,required:!0}},setup(){const e=(0,M.E)(),a=(0,C.T)();return{accountStore:e,generalStore:a}},data(){return{isLoadingDetail:!1,isLoading:!1,agentForm:{agent:{id:null,role:null,username:null,organization:null,email:null,phone:null,city:null,address:null,accepted:!1,blocked:!1,active:!1},rules:{required:e=>!!e||"Campo obrigatório",maxLength1:e=>e&&e.length<=25||"Máximo 25 caracteres",maxLength2:e=>e&&e.length<=50||"Máximo 50 caracteres",phone:e=>e&&9===e.length||"Número inválido",email:e=>/.+@.+\..+/.test(e)||"Email inválido"},valid:!1}}},watch:{dialog:{handler(){this.dialog&&this.onOpenDialog()}}},computed:{title(){return this.editMode?"Editar Conta ":"Detalhes da Conta "},itsMe(){return null!==this.me},localDialog:{get(){return this.dialog},set(e){this.$emit("update:dialog",e)}},roleColor(){return e=>{switch(e){case"Administrador":return"error";case"Organização":return"warning";case"Produtor":return"success";case"Agente de Campo":return"info";default:return"primary"}}}},methods:{async onOpenDialog(){this.itsMe?await this.getAgentDetail(this.me):await this.getAgentDetail(this.agent.id)},async getAgentDetail(e){this.isLoadingDetail=!0,await D.A.request({url:"api/agents/"+e,method:"GET",headers:{Authorization:"Bearer "+this.accountStore.account.token}}).then((e=>{this.agentForm.agent=e.data,console.log(e.data)})).catch((e=>{console.log(e)})).finally((()=>{this.isLoadingDetail=!1}))},editAgent(){this.itsMe?this.editMe():this.editOther()},async editMe(){this.isLoading=!0;let e={entity_name:this.agentForm.agent.name,entity_email:this.agentForm.agent.email,entity_phone:this.agentForm.agent.phone,entity_city:this.agentForm.agent.city,entity_address:this.agentForm.agent.address};await D.A.request({url:"api/agents/me",method:"patch",headers:{Authorization:"Bearer "+this.accountStore.account.token},data:e}).then((e=>{this.isLoading=!1,this.generalStore.successSnackbar("Conta editada com sucesso"),this.$emit("refresh"),this.localDialog=!1})).catch((e=>{console.log(e),this.isLoading=!1,this.generalStore.errorSnackbar("Erro ao editar a conta")}))},async editOther(){this.isLoading=!0;let e={agent_accepted:this.agentForm.agent.accepted,agent_blocked:this.agentForm.agent.blocked,agent_active:this.agentForm.agent.active,entity_name:this.agentForm.agent.name,entity_email:this.agentForm.agent.email,entity_phone:this.agentForm.agent.phone,entity_city:this.agentForm.agent.city,entity_address:this.agentForm.agent.address};await D.A.request({url:"api/agents/"+this.agent.id,method:"patch",headers:{Authorization:"Bearer "+this.accountStore.account.token},data:e}).then((e=>{this.isLoading=!1,this.generalStore.successSnackbar("Conta editada com sucesso"),this.$emit("refresh"),this.localDialog=!1})).catch((e=>{console.log(e),this.isLoading=!1,this.generalStore.errorSnackbar("Erro ao editar a conta")}))},openDialogwithID(e){this.agentForm.agent.id=e,this.localDialog=!0},reset(){this.agentForm.agent={id:null,role:null,username:null,organization:null,email:null,phone:null,city:null,address:null,accepted:!1,blocked:!1,active:!1}}}},W=t(1241);const A=(0,W.A)(L,[["render",w]]);var S=A},594:function(e,a,t){t.d(a,{N:function(){return k}});var l=t(6768),n=t(9562),o=t(7852),i=t(9669),r=t(5035),d=t(6106),s=t(4917),u=t(6935),c=t(9296),m=t(2067),g=t(144),h=t(4587),p=t(1247),v=t(6993),y=t(7861),F=t(4600),b=t(9094);const f=(0,h.j)({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...(0,r.V)(),...(0,s.EU)()},"VSwitch"),k=(0,p.RW)()({name:"VSwitch",inheritAttrs:!1,props:f(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,a){let{attrs:t,slots:h}=a;const p=(0,m.q)(e,"indeterminate"),f=(0,m.q)(e,"modelValue"),{loaderClasses:k}=(0,c.pn)(e),{isFocused:_,focus:V,blur:w}=(0,u.i)(e),M=(0,g.KR)(),C=v.ZK&&window.matchMedia("(forced-colors: active)").matches,D=(0,l.EW)((()=>"string"===typeof e.loading&&""!==e.loading?e.loading:e.color)),L=(0,y.v6)(),W=(0,l.EW)((()=>e.id||`switch-${L}`));function A(){p.value&&(p.value=!1)}function S(e){e.stopPropagation(),e.preventDefault(),M.value?.input?.click()}return(0,F.C)((()=>{const[a,u]=(0,b.ph)(t),m=r.Z.filterProps(e),g=s._F.filterProps(e);return(0,l.bF)(r.Z,(0,l.v6)({class:["v-switch",{"v-switch--flat":e.flat},{"v-switch--inset":e.inset},{"v-switch--indeterminate":p.value},k.value,e.class]},a,m,{modelValue:f.value,"onUpdate:modelValue":e=>f.value=e,id:W.value,focused:_.value,style:e.style}),{...h,default:a=>{let{id:t,messagesId:r,isDisabled:m,isReadonly:v,isValid:y}=a;const F={model:f,isValid:y};return(0,l.bF)(s._F,(0,l.v6)({ref:M},g,{modelValue:f.value,"onUpdate:modelValue":[e=>f.value=e,A],id:t.value,"aria-describedby":r.value,type:"checkbox","aria-checked":p.value?"mixed":void 0,disabled:m.value,readonly:v.value,onFocus:V,onBlur:w},u),{...h,default:e=>{let{backgroundColorClasses:a,backgroundColorStyles:t}=e;return(0,l.bF)("div",{class:["v-switch__track",C?void 0:a.value],style:t.value,onClick:S},[h["track-true"]&&(0,l.bF)("div",{key:"prepend",class:"v-switch__track-true"},[h["track-true"](F)]),h["track-false"]&&(0,l.bF)("div",{key:"append",class:"v-switch__track-false"},[h["track-false"](F)])])},input:a=>{let{inputNode:t,icon:r,backgroundColorClasses:s,backgroundColorStyles:u}=a;return(0,l.bF)(l.FK,null,[t,(0,l.bF)("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":r||e.loading},e.inset||C?void 0:s.value],style:e.inset?void 0:u.value},[h.thumb?(0,l.bF)(o.K,{defaults:{VIcon:{icon:r,size:"x-small"}}},{default:()=>[h.thumb({...F,icon:r})]}):(0,l.bF)(n.yX,null,{default:()=>[e.loading?(0,l.bF)(c.E2,{name:"v-switch",active:!0,color:!1===y.value?void 0:D.value},{default:e=>h.loader?h.loader(e):(0,l.bF)(d.x,{active:e.isActive,color:e.color,indeterminate:!0,size:"16",width:"2"},null)}):r&&(0,l.bF)(i.w,{key:String(r),icon:r,size:"x-small"},null)]})])])}})}})})),{}}})}}]);
//# sourceMappingURL=40.d72f7d8e.js.map