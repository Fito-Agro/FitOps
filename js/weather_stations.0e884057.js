"use strict";(self["webpackChunkfitoagro_backoffice"]=self["webpackChunkfitoagro_backoffice"]||[]).push([[571],{3245:function(e,t,a){a.d(t,{A:function(){return T}});var o=a(6768),r=a(4232),l=a(2807),i=a(4593),d=a(697),s=a(1606),n=a(1772),c=a(3813),u=a(6756),p=a(5526),m=a(9669),h=a(6106),v=a(594),f=a(1161);const S=(0,o.Lk)("h2",{class:"text-h5"}," Sem informação para esta estação nos últimos 7 dias ",-1),b={key:2},_={class:"text-h6"},g=(0,o.Lk)("br",null,null,-1),k=(0,o.Lk)("span",{class:"text-h6"},"Dados recolhidos nos últimos 7 dias",-1),W=(0,o.Lk)("br",null,null,-1),y=(0,o.Lk)("canvas",{id:"chart"},null,-1);function F(e,t,a,F,A,L){return(0,o.uX)(),(0,o.Wv)(n.p,{modelValue:A.dialog,"onUpdate:modelValue":t[1]||(t[1]=e=>A.dialog=e),onAfterLeave:t[2]||(t[2]=e=>L.reset()),width:"auto"},{activator:(0,o.k6)((({props:e})=>[(0,o.bF)(l.D,(0,o.v6)(e,{color:"info",size:"small",variant:"text",icon:""}),{default:(0,o.k6)((()=>[(0,o.bF)(m.w,null,{default:(0,o.k6)((()=>[(0,o.eW)("mdi-chart-line")])),_:1}),(0,o.bF)(f.y,{activator:"parent",location:"bottom"},{default:(0,o.k6)((()=>[(0,o.eW)(" Dados recolhidos ")])),_:1})])),_:2},1040)])),default:(0,o.k6)((({})=>[(0,o.bF)(i.J,{width:"900",height:"800"},{default:(0,o.k6)((()=>[(0,o.bF)(d.O,{class:"pb-0"},{default:(0,o.k6)((()=>[(0,o.bF)(c.I,{class:(0,r.C4)({"fill-height":A.isLoading||0==A.series.length})},{default:(0,o.k6)((()=>[A.isLoading?((0,o.uX)(),(0,o.Wv)(u.L,{key:0,align:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(p.B,{cols:"12",class:"d-flex align-center justify-center"},{default:(0,o.k6)((()=>[(0,o.bF)(h.x,{color:"secondary",size:"65",width:"7",indeterminate:""})])),_:1})])),_:1})):A.isLoading||0!=A.series.length?((0,o.uX)(),(0,o.CE)("div",b,[(0,o.bF)(u.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(p.B,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(i.J,{border:"",rounded:""},{default:(0,o.k6)((()=>[(0,o.bF)(s.r,null,{default:(0,o.k6)((()=>[(0,o.Lk)("span",_,"Selecione no máximo "+(0,r.v_)(A.maxSets)+" tipos de dados",1)])),_:1}),(0,o.bF)(d.O,{class:"scrollable-card py-2 px-5"},{default:(0,o.k6)((()=>[(0,o.bF)(u.L,{"no-gutters":""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(L.variablesColumns,((e,a)=>((0,o.uX)(),(0,o.Wv)(p.B,{cols:"6",key:a},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(L.variablesColumns[a],(e=>((0,o.uX)(),(0,o.Wv)(v.N,{key:e.series_variable.seriesvariable_id,modelValue:A.dataSets,"onUpdate:modelValue":t[0]||(t[0]=e=>A.dataSets=e),readonly:L.hasMaxedSets&&!A.dataSets.includes(e),label:e.series_variable.seriesvariable_longname,color:A.dataSets.includes(e)?L.getColor(e):"info",density:"compact",value:e,"hide-details":""},null,8,["modelValue","readonly","label","color","value"])))),128))])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),g,k,W,y])):((0,o.uX)(),(0,o.Wv)(u.L,{key:1},{default:(0,o.k6)((()=>[(0,o.bF)(p.B,null,{default:(0,o.k6)((()=>[(0,o.bF)(i.J,{class:"fill-width",elevation:"0"},{default:(0,o.k6)((()=>[(0,o.bF)(d.O,{class:"text-center"},{default:(0,o.k6)((()=>[(0,o.bF)(m.w,{size:"100"},{default:(0,o.k6)((()=>[(0,o.eW)("mdi-database-off")])),_:1}),S])),_:1})])),_:1})])),_:1})])),_:1}))])),_:1},8,["class"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}a(4114);var A=a(6591),L=(a(7249),a(8784)),V=a(6044),I=a(501),x=a(8355),w=a(144);A.Ay.register(L.Ay);var C={name:"StationData",props:{station_id:{type:Number,required:!0}},setup(){const e=(0,V.E)(),t=(0,I.T)();return{accountStore:e,generalStore:t}},data(){return{dialog:!1,isLoading:!0,series:[],mixedChart:null,dataSets:[],maxSets:3,colors:["#B00020","#00574b","#2196F3"]}},watch:{dialog(e){e&&this.onOpenDialog()},dataSets(e){this.mixedChart&&(console.log(this.chartData.datasets),this.mixedChart.data.datasets=this.chartData.datasets,this.mixedChart.options=this.options,this.mixedChart.update())}},computed:{lastWeekDate(){const e=new Date;return e.setDate(e.getDate()-7),e.toISOString().split("T")[0]},lastWeekDates(){const e=[],t=new Date;for(let a=6;a>=0;a--){const o=new Date(t);o.setDate(t.getDate()-a),e.push(o.toISOString().split("T")[0])}return e},todayDate(){return(new Date).toISOString().split("T")[0]},variablesColumns(){const e=Math.ceil(this.series.length/2);return[this.series.slice(0,e),this.series.slice(e)]},hasMaxedSets(){return this.dataSets.length>=this.maxSets},chartData(){let e=[];return this.dataSets.forEach(((t,a)=>{let o=[];t.series_data.forEach((e=>{o.push({x:e.seriesdata_timestamp,y:e.seriesdata_realvalue})})),e.push({type:"line",label:t.series_variable.seriesvariable_longname,backGroundColor:this.colors[a],borderColor:this.colors[a],borderWidth:1,stacK:"combined",pointRadius:1,data:o,yAxisID:"y"+t.series_id})})),{labels:[],datasets:e}},options(){let e=[];e.push({id:"x",type:"time",min:this.lastWeekDate+" 00:00",max:this.todayDate+" 23:59",time:{unit:"minute",tootipFormat:"yyyy-MM-dd HH:mm",displayFormats:{minute:"dd/MM"}},ticks:{stepSize:1440,fontColor:"black",fontSize:11,fontStyle:"bold",labelOffset:20,source:"auto"},display:!0,title:{display:!0,text:"Data"}}),this.dataSets.forEach(((t,a)=>{e.push({id:"y"+t.series_id,type:"linear",display:!0,position:"left",scaleLabel:{display:!0,labelString:t.series_variable.seriesvariable_longname},ticks:{beginAtZero:!0},title:{display:!0,color:this.colors[a],text:t.series_variable.unit_symbol}})}));let t={};return e.forEach((e=>{t[e.id]=e})),{responsive:!0,scales:t,plugins:{zoom:{pan:{enabled:!0,mode:"xy"},zoom:{wheel:{enabled:!0},pinch:{enabled:!0},mode:"xy"}}}}}},methods:{onOpenDialog(){this.getStationData()},reset(){this.series=[],this.dataSets=[],this.mixedChart&&this.mixedChart.clear()},async getStationData(){this.isLoading=!0,await x.A.request({url:`api/datasources/${this.station_id}/data`,method:"GET",headers:{Authorization:`Bearer ${this.accountStore.account.token}`},params:{start_date:this.lastWeekDate,end_date:this.todayDate}}).then((e=>{this.series=e.data,this.isLoading=!1,this.series.length>0&&this.$nextTick((()=>{this.loadChart()}))})).catch((e=>{console.log(e),this.isLoading=!1,this.generalStore.errorSnackbar("Erro ao buscar dados da estação."),this.dialog=!1}))},loadChart(){let e=document.getElementById("chart");this.mixedChart=(0,w.IJ)(new A.Ay(e,{options:this.options}))},getColor(e){return this.colors[this.dataSets.indexOf(e)]}}},E=a(1241);const M=(0,E.A)(C,[["render",F]]);var T=M},9679:function(e,t,a){a.r(t),a.d(t,{default:function(){return ca}});var o=a(6768),r=a(5130),l=a(2807),i=a(4593),d=a(1606),s=a(697),n=a(3813),c=a(6756),u=a(5526),p=a(9669),m=a(9336),h=a(105),v=a(3948);function f(e,t,a,f,S,b){const _=(0,o.g2)("AddWeatherStation"),g=(0,o.g2)("WeatherStationsTable"),k=(0,o.g2)("WeatherStationsMap");return(0,o.uX)(),(0,o.Wv)(n.I,{fluid:"",class:"fill-width"},{default:(0,o.k6)((()=>[(0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(i.J,{elevation:"8",loading:S.isLoading},{default:(0,o.k6)((()=>[(0,o.bF)(d.r,null,{default:(0,o.k6)((()=>[(0,o.eW)("Filtro")])),_:1}),(0,o.bF)(s.O,null,{default:(0,o.k6)((()=>[(0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"2"},{default:(0,o.k6)((()=>[(0,o.bF)(h.d4,{clearable:"",density:"comfortable",variant:"underlined",color:"primary",label:"Fornecedor",disabled:S.isLoading,loading:S.isLoading,items:b.filterSelectItems,"item-title":"dataprovider_name","item-value":"dataprovider_id",modelValue:S.filter.provider_Id,"onUpdate:modelValue":t[0]||(t[0]=e=>S.filter.provider_Id=e)},null,8,["disabled","loading","items","modelValue"])])),_:1}),(0,o.bF)(u.B,{cols:"2"},{default:(0,o.k6)((()=>[(0,o.bF)(v.W,{clearable:"",density:"comfortable",variant:"underlined",color:"primary",label:"Nome",modelValue:S.filter.datasource_name,"onUpdate:modelValue":t[1]||(t[1]=e=>S.filter.datasource_name=e)},null,8,["modelValue"])])),_:1}),(0,o.bF)(u.B,{cols:"2"},{default:(0,o.k6)((()=>[(0,o.bF)(v.W,{clearable:"",density:"comfortable",variant:"underlined",color:"primary",label:"ID Fornecedor",modelValue:S.filter.datasource_externalId,"onUpdate:modelValue":t[2]||(t[2]=e=>S.filter.datasource_externalId=e)},null,8,["modelValue"])])),_:1}),(0,o.bF)(u.B,{cols:"1"},{default:(0,o.k6)((()=>[(0,o.bF)(l.D,{color:"secondary",icon:"",variant:"text",onClick:t[3]||(t[3]=e=>b.searchFitagro())},{default:(0,o.k6)((()=>[(0,o.bF)(p.w,{size:"x-large"},{default:(0,o.k6)((()=>[(0,o.eW)("mdi-magnify")])),_:1})])),_:1})])),_:1}),f.accountStore.hasRole(["Administrador"])?((0,o.uX)(),(0,o.Wv)(u.B,{key:0,cols:"5",class:"d-flex justify-center"},{default:(0,o.k6)((()=>[(0,o.bF)(_,{onUpdateWS:t[4]||(t[4]=e=>b.getWSfromFitoagro())})])),_:1})):(0,o.Q3)("",!0)])),_:1})])),_:1})])),_:1},8,["loading"])])),_:1})])),_:1}),(0,o.bo)((0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"7"},{default:(0,o.k6)((()=>[(0,o.bF)(g,{tableItems:b.tableItems,"onUpdate:WSfromFitoAgro":t[5]||(t[5]=e=>b.getWSfromFitoagro())},null,8,["tableItems"])])),_:1}),(0,o.bF)(u.B,{cols:"5"},{default:(0,o.k6)((()=>[(0,o.bF)(k,{WSfromFitoagro:b.mapIcons,onLoaded:t[6]||(t[6]=e=>S.isLoading=!1)},null,8,["WSfromFitoagro"])])),_:1})])),_:1},512),[[r.aG,!S.isLoading]]),S.isLoading?((0,o.uX)(),(0,o.Wv)(c.L,{key:0,align:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{class:"d-flex align-center justify-center"},{default:(0,o.k6)((()=>[(0,o.bF)(m.Z,{color:"secondary",size:"65",width:"7",indeterminate:""})])),_:1})])),_:1})):(0,o.Q3)("",!0)])),_:1})}a(4114);var S=a(4232),b=a(3745),_=a(5523),g=a(1867),k=a(1772),W=a(1146),y=a(1161);const F={class:"text-center"},A={key:0,class:"d-flex justify-space-evenly nowrap"},L=(0,o.Lk)("span",null,"Remover Estação",-1);function V(e,t,a,r,n,m){const h=(0,o.g2)("WeatherStationDetail");return(0,o.uX)(),(0,o.Wv)(W.i,{class:"pa-2",elevation:"8",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(g.g,{"fixed-headers":"","no-data-text":"Nenhuma estação encontrada","loading-text":"Carregando estações...",headers:m.headers,items:a.tableItems,height:m.tableHeight},{item:(0,o.k6)((e=>[(0,o.Lk)("tr",null,[(0,o.Lk)("td",null,[(0,o.bF)(l.D,{color:"info",variant:"text",icon:"mdi-information-outline",onClick:t=>m.showInfo(e.item)},null,8,["onClick"])]),(0,o.Lk)("td",null,(0,S.v_)(e.item.datasource_name),1),(0,o.Lk)("td",null,[(0,o.bF)(_.x,{color:e.item.dataprovider_name,variant:"outlined"},{default:(0,o.k6)((()=>[(0,o.eW)((0,S.v_)(e.item.dataprovider_name),1)])),_:2},1032,["color"])]),(0,o.Lk)("td",null,(0,S.v_)(e.item.datasource_externalId),1),(0,o.Lk)("td",F,[(0,o.bF)(l.D,{color:"info",variant:"text",icon:"",onClick:t=>m.showOnMap(e.item)},{default:(0,o.k6)((()=>[(0,o.bF)(p.w,null,{default:(0,o.k6)((()=>[(0,o.eW)("mdi-crosshairs-gps")])),_:1}),(0,o.bF)(y.y,{activator:"parent",location:"bottom"},{default:(0,o.k6)((()=>[(0,o.eW)((0,S.v_)(e.item.location),1)])),_:2},1024)])),_:2},1032,["onClick"])]),r.accountStore.hasRole(["Administrador"])?((0,o.uX)(),(0,o.CE)("td",A,[(0,o.bF)(l.D,{color:"warning",variant:"text",icon:"",onClick:t=>m.openEditDialog(e.item)},{default:(0,o.k6)((()=>[(0,o.bF)(p.w,null,{default:(0,o.k6)((()=>[(0,o.eW)("mdi-pencil")])),_:1}),(0,o.bF)(y.y,{activator:"parent",location:"bottom"},{default:(0,o.k6)((()=>[(0,o.eW)(" Editar ")])),_:1})])),_:2},1032,["onClick"]),(0,o.bF)(l.D,{color:"error",variant:"text",icon:"",onClick:t=>m.openRemoveDialog(e.item)},{default:(0,o.k6)((()=>[(0,o.bF)(p.w,null,{default:(0,o.k6)((()=>[(0,o.eW)("mdi-delete-outline")])),_:1}),(0,o.bF)(y.y,{activator:"parent",location:"bottom"},{default:(0,o.k6)((()=>[(0,o.eW)(" Remover ")])),_:1})])),_:2},1032,["onClick"])])):(0,o.Q3)("",!0)])])),_:1},8,["headers","items","height"]),(0,o.bF)(k.p,{modelValue:n.deleteDialog,"onUpdate:modelValue":t[5]||(t[5]=e=>n.deleteDialog=e),onAfterLeave:t[6]||(t[6]=e=>m.reset()),persistent:"",width:"auto"},{default:(0,o.k6)((()=>[(0,o.bF)(i.J,{width:"32rem"},{default:(0,o.k6)((()=>[(0,o.bF)(d.r,{class:"bg-error d-flex align-center"},{default:(0,o.k6)((()=>[(0,o.bF)(p.w,{size:"small",class:"mr-2"},{default:(0,o.k6)((()=>[(0,o.eW)("mdi-delete-outline")])),_:1}),L])),_:1}),(0,o.bF)(s.O,null,{default:(0,o.k6)((()=>[(0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(v.W,{color:"secondary",variant:"outlined",readonly:"","hide-details":"",density:"compact",modelValue:n.station.datasource_name,"onUpdate:modelValue":t[0]||(t[0]=e=>n.station.datasource_name=e),label:"Nome da estação",required:""},null,8,["modelValue"])])),_:1}),(0,o.bF)(u.B,{cols:"6"},{default:(0,o.k6)((()=>[(0,o.bF)(v.W,{color:"secondary",variant:"outlined",readonly:"","hide-details":"",density:"compact",modelValue:n.station.dataprovider_name,"onUpdate:modelValue":t[1]||(t[1]=e=>n.station.dataprovider_name=e),label:"Fornecedor",required:""},null,8,["modelValue"])])),_:1}),(0,o.bF)(u.B,{cols:"6"},{default:(0,o.k6)((()=>[(0,o.bF)(v.W,{color:"secondary",variant:"outlined",readonly:"","hide-details":"",density:"compact",modelValue:n.station.datasource_externalId,"onUpdate:modelValue":t[2]||(t[2]=e=>n.station.datasource_externalId=e),label:"Identificador",required:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,o.bF)(b.S,{class:"d-flex justify-space-around"},{default:(0,o.k6)((()=>[(0,o.bF)(l.D,{color:"error",variant:"tonal",icon:"mdi-close",onClick:t[3]||(t[3]=e=>n.deleteDialog=!1)}),(0,o.bF)(l.D,{color:"secondary",variant:"tonal",icon:"mdi-check",loading:n.isLoading,onClick:t[4]||(t[4]=e=>m.deleteStation())},null,8,["loading"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.bF)(h,{stationOnFocus:n.station,dialog:n.detailDialog,editMode:n.editMode,"onUpdate:dialog":t[7]||(t[7]=e=>n.detailDialog=e),"onUpdate:WSfromFitoAgro":t[8]||(t[8]=t=>e.$emit("update:WSfromFitoAgro"))},null,8,["stationOnFocus","dialog","editMode"])])),_:1})}var I=a(3367);const x=(0,I.nY)("weatherStore",{state:()=>({WSonFocus:{},WSfromFitoagro:{},providersFromFitoagro:{},WStoAdd:null,providerToAdd:null,providerAccountToAdd:null,authWiseCrop:{token:null,expeiration_date:null,cookies:null}}),actions:{resetWStoAdd(){this.WStoAdd=null},resetProviderToAdd(){this.providerToAdd=null,this.providerAccountToAdd=null}}});var w=a(501),C=a(6044),E=a(7511),M=a(1560),T=a(6106),D=a(594);const P=e=>((0,o.Qi)("data-v-17917c8e"),e=e(),(0,o.jt)(),e),B={key:0},j=P((()=>(0,o.Lk)("span",null,"Editar Estação",-1))),X={key:1},O=P((()=>(0,o.Lk)("span",null,"Detalhes da Estação",-1))),z=P((()=>(0,o.Lk)("span",null,"Informação a Recolher",-1)));function U(e,t,a,r,m,h){const f=(0,o.g2)("StationData");return(0,o.uX)(),(0,o.Wv)(k.p,{modelValue:h.localDialog,"onUpdate:modelValue":t[7]||(t[7]=e=>h.localDialog=e),onAferleave:t[8]||(t[8]=e=>h.onCloseDialog()),width:"auto"},{default:(0,o.k6)((()=>[(0,o.bF)(i.J,{width:"500",height:"600"},{default:(0,o.k6)((()=>[(0,o.bF)(d.r,{class:(0,S.C4)(a.editMode?"bg-warning":"bg-info")},{default:(0,o.k6)((()=>[a.editMode?((0,o.uX)(),(0,o.CE)("div",B,[(0,o.bF)(p.w,{size:"small",class:"mr-2"},{default:(0,o.k6)((()=>[(0,o.eW)("mdi-pencil")])),_:1}),j])):((0,o.uX)(),(0,o.CE)("div",X,[(0,o.bF)(p.w,{size:"small",class:"mr-2"},{default:(0,o.k6)((()=>[(0,o.eW)("mdi-information-outline")])),_:1}),O]))])),_:1},8,["class"]),(0,o.bF)(s.O,{class:"pb-1"},{default:(0,o.k6)((()=>[(0,o.bF)(n.I,{class:(0,S.C4)({"fill-height":m.isLoading})},{default:(0,o.k6)((()=>[m.isLoading?((0,o.uX)(),(0,o.Wv)(c.L,{key:0,align:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"12",class:"d-flex align-center justify-center"},{default:(0,o.k6)((()=>[(0,o.bF)(T.x,{color:"secondary",size:"65",width:"7",indeterminate:""})])),_:1})])),_:1})):m.isLoading||null==m.station?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(M.n,{key:1,modelValue:m.formValid,"onUpdate:modelValue":t[4]||(t[4]=e=>m.formValid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(v.W,{modelValue:m.station.datasource_name,"onUpdate:modelValue":t[0]||(t[0]=e=>m.station.datasource_name=e),modelModifiers:{trim:!0},rules:m.rules.name,readonly:!a.editMode,color:"secondary",label:"Nome da Estação","prepend-icon":"mdi-tag-text-outline",density:"compact",variant:"outlined"},null,8,["modelValue","rules","readonly"])])),_:1})])),_:1}),(0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"6"},{default:(0,o.k6)((()=>[(0,o.bF)(v.W,{modelValue:m.station.dataprovider.dataprovider_name,"onUpdate:modelValue":t[1]||(t[1]=e=>m.station.dataprovider.dataprovider_name=e),readonly:"",disabled:a.editMode,color:"secondary",label:"Fornecedor","prepend-icon":"mdi-domain",density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue","disabled"])])),_:1}),(0,o.bF)(u.B,{cols:"6"},{default:(0,o.k6)((()=>[(0,o.bF)(v.W,{modelValue:m.station.datasource_externalid,"onUpdate:modelValue":t[2]||(t[2]=e=>m.station.datasource_externalid=e),readonly:"",disabled:a.editMode,color:"secondary",label:"Identificador de Fornecedor","prepend-icon":"mdi-identifier",density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue","disabled"])])),_:1})])),_:1}),(0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,null,{default:(0,o.k6)((()=>[(0,o.bF)(i.J,{height:"280",class:"pa-2",elevation:"0",border:"",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(d.r,{class:"d-flex align-center pl-2"},{default:(0,o.k6)((()=>[a.editMode?((0,o.uX)(),(0,o.Wv)(l.D,{key:0,color:"info",variant:"text",icon:"",onClick:t[3]||(t[3]=e=>h.selectAll())},{default:(0,o.k6)((()=>[(0,o.bF)(p.w,null,{default:(0,o.k6)((()=>[(0,o.eW)("mdi-playlist-check")])),_:1}),(0,o.bF)(y.y,{activator:"parent",location:"bottom"},{default:(0,o.k6)((()=>[(0,o.eW)("Selecionar todos")])),_:1})])),_:1})):(0,o.Q3)("",!0),z,a.editMode?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(f,{key:1,station_id:m.station.datasource_id},null,8,["station_id"]))])),_:1}),(0,o.bF)(s.O,{class:"scrollable-card"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(m.stationSeries,((e,t)=>((0,o.uX)(),(0,o.Wv)(D.N,{key:t,modelValue:e.active,"onUpdate:modelValue":t=>e.active=t,label:e.seriesvariable_longname,readonly:!a.editMode,color:"secondary",density:"comfortable","hide-details":""},null,8,["modelValue","onUpdate:modelValue","label","readonly"])))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]))])),_:1},8,["class"])])),_:1}),(0,o.bF)(E.G),a.editMode?((0,o.uX)(),(0,o.Wv)(b.S,{key:0,class:"d-flex justify-space-around"},{default:(0,o.k6)((()=>[(0,o.bF)(l.D,{color:"error",variant:"tonal",icon:"mdi-close",onClick:t[5]||(t[5]=e=>h.localDialog=!1)}),(0,o.bF)(l.D,{color:"secondary",variant:"tonal",icon:"mdi-check",loading:m.isLoadingEdit,disabled:!m.formValid,onClick:t[6]||(t[6]=e=>h.editStation())},null,8,["loading","disabled"])])),_:1})):(0,o.Q3)("",!0)])),_:1})])),_:1},8,["modelValue"])}var J=a(3245),N=a(8355),$={name:"WeatherStationDetail",components:{StationData:J.A},props:{stationOnFocus:{type:Object},dialog:{type:Boolean,required:!0},editMode:{type:Boolean,required:!1,default:!1}},setup(){const e=(0,C.E)(),t=(0,w.T)();return{accountStore:e,generalStore:t}},data(){return{isLoading:!1,isLoadingEdit:!1,formValid:!1,station:null,seriesVariables:[],stationSeries:[],rules:{name:[e=>!!e||"O nome é obrigatório",e=>e&&e.length<=50||"O nome deve ter menos de 50 caracteres"]}}},watch:{dialog:{handler(){this.dialog&&this.onOpenDialog()}}},computed:{localDialog:{get(){return this.dialog},set(e){this.$emit("update:dialog",e)}}},methods:{async getStationDetail(){let e=this.stationOnFocus.datasource_id;await N.A.request({url:"api/datasources/"+e,method:"get",headers:{Authorization:"Bearer "+this.accountStore.account.token}}).then((e=>{this.station={...e.data,seriesvariables:e.data.series.map((e=>e.seriesvariable_id))}})).catch((e=>{console.log(e)}))},async getProviderSeries(){let e=this.stationOnFocus.dataprovider_id;await N.A.request({url:"api/dataprovider/"+e+"/seriesvariables",method:"get",headers:{Authorization:"Bearer "+this.accountStore.account.token}}).then((e=>{this.seriesVariables=e.data})).catch((e=>{console.log(e)}))},selectAll(){this.stationSeries=this.stationSeries.map((e=>({...e,active:!0})))},async editStation(){this.isLoadingEdit=!0;let e={datasource_name:this.station.datasource_name,seriesvariables:this.stationSeries};console.log(e),await N.A.request({url:"api/dataproviders/"+this.station.dataprovider.dataprovider_id+"/datasources/"+this.station.datasource_id,method:"patch",headers:{Authorization:"Bearer "+this.accountStore.account.token},data:e}).then((e=>{this.isLoadingEdit=!1,this.localDialog=!1,this.generalStore.successSnackbar("Estação editada com sucesso"),this.$emit("update:WSfromFitoAgro")})).catch((e=>{console.log(e),this.isLoadingEdit=!1,this.generalStore.errorSnackbar("Erro ao editar a estação")}))},onOpenDialog(){this.isLoading=!0,Promise.all([this.getProviderSeries(),this.getStationDetail()]).then((()=>{this.stationSeries=this.seriesVariables.map((e=>({...e,active:this.belongsToSeries(e.seriesvariable_id)}))),this.isLoading=!1})).catch((e=>{console.log(e)}))},onCloseDialog(){this.dialog=!1,this.station=null,this.seriesVariables=[],this.stationSeries=[]},belongsToSeries(e){let t=this.station.series.find((t=>t.seriesvariable_id===e));return!!t}}},Q=a(1241);const q=(0,Q.A)($,[["render",U],["__scopeId","data-v-17917c8e"]]);var R=q,H=(a(8036),{name:"WeatherStationsTable",components:{WeatherStationDetail:R},props:{tableItems:{type:Array,required:!0}},setup(){const e=x(),t=(0,w.T)(),a=(0,C.E)();return{weatherStore:e,accountStore:a,generalStore:t}},data(){return{deleteDialog:!1,detailDialog:!1,editMode:!1,editFormValid:!1,isLoading:!1,station:null,rules:{edit:{name:[e=>!!e||"Insira o nome da estação"]}}}},computed:{tableHeight(){return window.innerHeight-260},headers(){let e=[{text:"",value:"info"},{title:"Nome",key:"datasource_name"},{title:"Fornecedor",key:"dataprovider_name",order:"asc"},{title:"ID Fornecedor",key:"datasource_externalId"},{title:"Localização",align:"center"}];return this.accountStore.hasRole(["Administrador"])&&e.push({title:"Ações",align:"center"}),e}},methods:{showOnMap(e){this.weatherStore.WSonFocus=e},showInfo(e){this.station=Object.assign({},e),this.editMode=!1,this.detailDialog=!0},openRemoveDialog(e){this.deleteDialog=!0,this.station=Object.assign({},e)},openEditDialog(e){this.station=Object.assign({},e),this.editMode=!0,this.detailDialog=!0},deleteStation(){this.isLoading=!0,console.log(this.station),N.A.request({url:"/api/dataproviders/"+this.station.dataprovider_id+"/datasources/"+this.station.datasource_id,method:"delete",headers:{Authorization:"Bearer "+this.accountStore.account.token}}).then((e=>{this.isLoading=!1,this.deleteDialog=!1,this.generalStore.successSnackbar("Estação removida com sucesso"),this.$emit("update:WSfromFitoAgro")})).catch((e=>{console.log(e.response),this.isLoading=!1,this.generalStore.errorSnackbar(e.response.data.error,3e3)}))},providerColor(e){switch(e){case"PESSL":return"#0a876a";case"APAS":return"#999900";case"IPMA":return"#33ccff";case"WiseCrop":return"#993300";case"TerraPro":return"#3366ff";default:return"grey"}},reset(){this.station=null}}});const K=(0,Q.A)(H,[["render",V]]);var G=K;function Z(e,t,a,r,l,i){const d=(0,o.g2)("MapboxMap");return(0,o.uX)(),(0,o.Wv)(W.i,{class:"pa-2",elevation:"8",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(d,{ref:"mapboxMap",accessToken:r.accessToken,mapStyle:"mapbox://styles/mapbox/satellite-streets-v12",onMbCreated:t[0]||(t[0]=e=>{l.map=e}),center:l.mapCenter,zoom:8,style:(0,S.Tr)({height:i.mapHeight+"px"})},null,8,["accessToken","center","style"])])),_:1})}var Y=a(8035),ee=a(2693),te=a.n(ee),ae={name:"WeatherStationsMap",components:{MapboxMap:Y.ae},props:{WSfromFitoagro:{type:Object,default:()=>({type:"FeatureCollection",features:[]})}},setup(){const e=x(),t=new(te().Popup)({closeButton:!1,closeOnClick:!1}),a="pk.eyJ1IjoibXJiYWlhbyIsImEiOiJjbHlzamJ3NzgwZTF2MmlxdjI1aWFvMDJ3In0.iLJP5hiKMbSd113vFLBRtg";return{weatherStore:e,popup:t,accessToken:a}},data(){return{map:null,mapCenter:[-9,39]}},watch:{WSonFocus:{handler:function(e,t){e&&this.map.flyTo({center:e.location,zoom:12})},deep:!0},WSfromFitoagro:{handler:function(e,t){let a=this.map.getSource("weather-stations-fitoagro");a&&a.setData(e)},deep:!0}},mounted(){this.map.on("load",(()=>{this.map.addSource("weather-stations-fitoagro",{type:"geojson",data:this.WSfromFitoagro}),this.map.addLayer({id:"weather-stations-fitoagro",type:"circle",source:"weather-stations-fitoagro",paint:{"circle-radius":6,"circle-color":["match",["get","dataprovider_name"],"PESSL","#0a876a","APAS","#999900","IPMA","#33ccff","WiseCrop","#993300","TerraPro","#3366ff","#f0f"],"circle-stroke-width":1,"circle-stroke-color":"#fff"}}),this.map.on("mouseenter","weather-stations-fitoagro",(e=>{this.map.getCanvas().style.cursor="pointer";let t=e.features[0].geometry.coordinates.slice(),a="<b>Local:</b> "+e.features[0].properties.datasource_name+"<br> <b>Fornecedor:</b> "+e.features[0].properties.dataprovider_name;this.popup.setLngLat(t).setHTML(a).addTo(this.map)})),this.map.on("mouseleave","weather-stations-fitoagro",(()=>{this.map.getCanvas().style.cursor="",this.popup.remove()})),this.map.on("mouseenter","weather-stations-IPMA",(e=>{this.map.getCanvas().style.cursor="pointer";let t=e.features[0].geometry.coordinates.slice(),a="<b>Local:</b> "+e.features[0].properties.localEstacao+"<br> <b>ID:</b> "+e.features[0].properties.idEstacao;this.popup.setLngLat(t).setHTML(a).addTo(this.map)})),this.map.on("mouseleave","weather-stations-IPMA",(()=>{this.map.getCanvas().style.cursor="",this.popup.remove()}))})),this.$emit("loaded")},computed:{mapHeight(){return window.innerHeight-260},notWSfromFitoagro(){let e=this.WSfromIPMA.features.filter((e=>!this.WSfromFitoagro.features.some((t=>parseInt(t.properties.datasource_externalId)===e.properties.idEstacao))));return{type:"FeatureCollection",features:e}},WSonFocus(){return this.weatherStore.WSonFocus}}};const oe=(0,Q.A)(ae,[["render",Z]]);var re=oe,le=a(266),ie=a(54);const de=(0,o.Lk)("span",{class:"text-subtitle-1 text-medium-emphasis"}," Selecione um Fornecedor ",-1),se={key:0},ne=(0,o.Lk)("span",{class:"text-subtitle-1 text-medium-emphasis"}," Seleciona uma Conta de Fornecedor ",-1),ce={key:0,class:"mb-4"},ue={key:1,class:"mb-4"},pe={key:2,class:"mb-4 mr-4"},me={key:3},he={key:4},ve={class:"d-flex justify-space-between pa-2"};function fe(e,t,a,r,i,d){const s=(0,o.g2)("AddPESSLWeatherStation"),n=(0,o.g2)("AddAPASWeatherStation"),p=(0,o.g2)("AddIPMAWeatherStation"),m=(0,o.g2)("AddWisecropWeatherStation"),v=(0,o.g2)("AddTerraproWeatherStation"),f=(0,o.g2)("WSForm");return(0,o.uX)(),(0,o.Wv)(k.p,{modelValue:i.mainDialog,"onUpdate:modelValue":t[19]||(t[19]=e=>i.mainDialog=e),onAfterLeave:t[20]||(t[20]=e=>d.reset()),width:"auto"},{activator:(0,o.k6)((({props:e})=>[(0,o.bF)(l.D,(0,o.v6)(e,{color:"success",text:"Nova estação","append-icon":"mdi-plus"}),null,16)])),default:(0,o.k6)((({})=>[(0,o.bF)(ie.gW,{modelValue:i.currStep,"onUpdate:modelValue":t[18]||(t[18]=e=>i.currStep=e),items:i.steps,ref:"stepper",width:"auto","min-width":"50rem"},{"item.1":(0,o.k6)((()=>[(0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"12",class:"d-flex justify-center"},{default:(0,o.k6)((()=>[(0,o.bF)(W.i,{rounded:"",border:"",class:"pa-5",width:"25rem"},{default:(0,o.k6)((()=>[(0,o.bF)(M.n,{modelValue:i.steps[0].formValid,"onUpdate:modelValue":t[2]||(t[2]=e=>i.steps[0].formValid=e),"lazy-validation":""},{default:(0,o.k6)((()=>[(0,o.Lk)("div",null,[de,(0,o.bF)(h.d4,{class:"mt-4",density:"compact",variant:"outlined","prepend-inner-icon":"mdi-domain",label:"Fornecedor",items:d.selectItemsProvider,rules:i.steps[0].rules.provider,"item-title":"dataprovider_name",modelValue:i.providerSelected,"onUpdate:modelValue":t[0]||(t[0]=e=>i.providerSelected=e),"return-object":"",required:""},null,8,["items","rules","modelValue"])]),i.needsAccount?((0,o.uX)(),(0,o.CE)("div",se,[ne,(0,o.bF)(h.d4,{class:"mt-4",density:"compact",variant:"outlined","prepend-inner-icon":"mdi-account-outline",label:"Conta de Fornecedor","no-data-text":"Nenhuma conta disponível",loading:i.loadingAccounts,disabled:i.loadingAccounts,items:i.providerAccounts,rules:i.steps[0].rules.proAcc,"item-title":"agent_username",modelValue:i.providerAccSelected,"onUpdate:modelValue":t[1]||(t[1]=e=>i.providerAccSelected=e),"return-object":"",required:""},null,8,["loading","disabled","items","rules","modelValue"])])):(0,o.Q3)("",!0)])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),"item.2":(0,o.k6)((()=>["PESSL"==d.providerNameSelected?((0,o.uX)(),(0,o.CE)("div",ce,[(0,o.bF)(s,{WStoAdd:i.WStoAdd,providerSelected:i.providerSelected,providerAccount:i.providerAccSelected,WSfromFitoAgro:i.WSfromFitoagro,formValid:i.steps[1].formValid,"onUpdate:WStoAdd":t[3]||(t[3]=e=>i.WStoAdd=e),"onUpdate:formValid":t[4]||(t[4]=e=>d.updateFormValid(1,e))},null,8,["WStoAdd","providerSelected","providerAccount","WSfromFitoAgro","formValid"])])):"APAS"==d.providerNameSelected?((0,o.uX)(),(0,o.CE)("div",ue,[(0,o.bF)(n,{WStoAdd:i.WStoAdd,providerSelected:i.providerSelected,providerAccount:i.providerAccSelected,WSfromFitoAgro:i.WSfromFitoagro,formValid:i.steps[1].formValid,"onUpdate:WStoAdd":t[5]||(t[5]=e=>i.WStoAdd=e),"onUpdate:formValid":t[6]||(t[6]=e=>d.updateFormValid(1,e))},null,8,["WStoAdd","providerSelected","providerAccount","WSfromFitoAgro","formValid"])])):"IPMA"==d.providerNameSelected?((0,o.uX)(),(0,o.CE)("div",pe,[(0,o.bF)(p,{WStoAdd:i.WStoAdd,providerSelected:i.providerSelected,WSfromFitoAgro:i.WSfromFitoagro,formValid:i.steps[1].formValid,"onUpdate:WStoAdd":t[7]||(t[7]=e=>i.WStoAdd=e),"onUpdate:formValid":t[8]||(t[8]=e=>d.updateFormValid(1,e))},null,8,["WStoAdd","providerSelected","WSfromFitoAgro","formValid"])])):"WiseCrop"==d.providerNameSelected?((0,o.uX)(),(0,o.CE)("div",me,[(0,o.bF)(m,{WStoAdd:i.WStoAdd,provider:i.providerSelected,providerAccount:i.providerAccSelected,WSfromFitoAgro:i.WSfromFitoagro,formValid:i.steps[1].formValid,"onUpdate:WStoAdd":t[9]||(t[9]=e=>i.WStoAdd=e),"onUpdate:formValid":t[10]||(t[10]=e=>d.updateFormValid(1,e))},null,8,["WStoAdd","provider","providerAccount","WSfromFitoAgro","formValid"])])):"TerraPro"==d.providerNameSelected?((0,o.uX)(),(0,o.CE)("div",he,[(0,o.bF)(v,{WStoAdd:i.WStoAdd,provider:i.providerSelected,providerAccount:i.providerAccSelected,WSfromFitoAgro:i.WSfromFitoagro,formValid:i.steps[1].formValid,"onUpdate:WStoAdd":t[11]||(t[11]=e=>i.WStoAdd=e),"onUpdate:formValid":t[12]||(t[12]=e=>d.updateFormValid(1,e))},null,8,["WStoAdd","provider","providerAccount","WSfromFitoAgro","formValid"])])):((0,o.uX)(),(0,o.Wv)(c.L,{key:5},{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(le.l,{dense:"",outlined:"",color:"warning",icon:"mdi-alert",text:""},{default:(0,o.k6)((()=>[(0,o.eW)(" Fornecedor não suportado ")])),_:1})])),_:1})])),_:1}))])),"item.3":(0,o.k6)((()=>[(0,o.bF)(f,{station:i.WStoAdd,formValid:i.steps[2].formValid,"onUpdate:station":t[13]||(t[13]=e=>i.WStoAdd=e),"onUpdate:formValid":t[14]||(t[14]=e=>d.updateFormValid(2,e))},null,8,["station","formValid"])])),actions:(0,o.k6)((()=>[(0,o.Lk)("div",ve,[(0,o.bF)(l.D,{"prepend-icon":"mdi-arrow-left",color:"info",variant:"tonal",onClick:t[15]||(t[15]=e=>r.stepper.prev()),disabled:1==i.currStep},{default:(0,o.k6)((()=>[(0,o.eW)("Anterior")])),_:1},8,["disabled"]),i.currStep<d.lastStep?((0,o.uX)(),(0,o.Wv)(l.D,{key:0,color:"info",variant:"tonal","append-icon":"mdi-arrow-right",loading:i.isLoading,disabled:!i.steps[i.currStep-1].formValid,onClick:t[16]||(t[16]=e=>r.stepper.next())},{default:(0,o.k6)((()=>[(0,o.eW)("Próximo")])),_:1},8,["loading","disabled"])):((0,o.uX)(),(0,o.Wv)(l.D,{key:1,color:"success",variant:"flat",disabled:!i.steps[i.currStep-1].formValid,onClick:t[17]||(t[17]=e=>d.postWStoFitoAgro()),"append-icon":"mdi-check"},{default:(0,o.k6)((()=>[(0,o.eW)("Adicionar")])),_:1},8,["disabled"]))])])),_:1},8,["modelValue","items"])])),_:1},8,["modelValue"])}var Se=a(2239);const be={key:0},_e=(0,o.Lk)("b",null,"Fornecedor:",-1),ge=(0,o.Lk)("br",null,null,-1),ke=(0,o.Lk)("br",null,null,-1),We=(0,o.Lk)("br",null,null,-1),ye=(0,o.Lk)("b",null," Localização: ",-1),Fe=(0,o.Lk)("br",null,null,-1),Ae=(0,o.Lk)("b",null,"Longitude:",-1),Le=(0,o.Lk)("br",null,null,-1),Ve=(0,o.Lk)("b",null,"Latitude:",-1),Ie=(0,o.Lk)("br",null,null,-1);function xe(e,t,a,r,l,i){const d=(0,o.g2)("SeriesProvider"),s=(0,o.g2)("MapboxMap");return(0,o.uX)(),(0,o.Wv)(W.i,{class:"",width:"65rem"},{default:(0,o.k6)((()=>[(0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"5"},{default:(0,o.k6)((()=>[(0,o.bF)(W.i,{class:"pa-2 mb-4",border:"",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(M.n,{modelValue:i.localFormValid,"onUpdate:modelValue":t[1]||(t[1]=e=>i.localFormValid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(Se.V,{modelValue:i.localWStoAdd,"onUpdate:modelValue":t[0]||(t[0]=e=>i.localWStoAdd=e),class:"mt-4",label:"Estações disponíveis",variant:"outlined",color:"secondary",items:i.selectItemsWS,"item-title":"displayName",rules:l.rules,"return-object":""},null,8,["modelValue","items","rules"])])),_:1},8,["modelValue"]),null!=a.WStoAdd?((0,o.uX)(),(0,o.CE)("div",be,[(0,o.bF)(E.G),(0,o.bF)(W.i,{class:"mt-4"},{default:(0,o.k6)((()=>[(0,o.Lk)("span",null,[_e,(0,o.eW)(" "+(0,S.v_)(a.WStoAdd.dataprovider_name),1)]),ge,(0,o.Lk)("span",null,[(0,o.Lk)("b",null," Identificador "+(0,S.v_)(a.WStoAdd.dataprovider_name)+": ",1),(0,o.eW)(" "+(0,S.v_)(a.WStoAdd.datasource_externalId),1)]),ke,We,(0,o.Lk)("span",null,[ye,(0,o.eW)(" "+(0,S.v_)(a.WStoAdd.datasource_name),1)]),Fe,(0,o.Lk)("span",null,[Ae,(0,o.eW)(" "+(0,S.v_)(a.WStoAdd.location[0]),1)]),Le,(0,o.Lk)("span",null,[Ve,(0,o.eW)(" "+(0,S.v_)(a.WStoAdd.location[1]),1)]),Ie])),_:1})])):(0,o.Q3)("",!0)])),_:1}),null!=a.WStoAdd?((0,o.uX)(),(0,o.Wv)(d,{key:0,providerSelected:a.providerSelected,WStoAdd:i.localWStoAdd,formValid:i.localFormValid,"onUpdate:WStoAdd":t[2]||(t[2]=e=>a.WStoAdd=e),"onUpdate:formValid":t[3]||(t[3]=e=>a.formValid=e)},null,8,["providerSelected","WStoAdd","formValid"])):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)(u.B,{cols:"7"},{default:(0,o.k6)((()=>[(0,o.bF)(W.i,{class:"pa-2",border:"",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{ref:"mapboxMap",accessToken:r.accessToken,mapStyle:"mapbox://styles/mapbox/satellite-streets-v12",onMbCreated:t[4]||(t[4]=e=>l.map=e),center:l.mapCenter,zoom:8,style:{height:"40rem"}},null,8,["accessToken","center"])])),_:1})])),_:1})])),_:1})])),_:1})}var we=a(8738);const Ce=e=>((0,o.Qi)("data-v-7ebe908c"),e=e(),(0,o.jt)(),e),Ee=Ce((()=>(0,o.Lk)("span",null,"Informação a Recolher",-1))),Me={key:0},Te={key:1};function De(e,t,a,r,n,c){return(0,o.uX)(),(0,o.Wv)(i.J,{class:"pa-2",elevation:"0",border:"",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(d.r,{class:"d-flex align-center pl-2"},{default:(0,o.k6)((()=>[(0,o.bF)(l.D,{color:"info",variant:"text",icon:"",onClick:t[0]||(t[0]=e=>c.selectAll())},{default:(0,o.k6)((()=>[(0,o.bF)(p.w,null,{default:(0,o.k6)((()=>[(0,o.eW)("mdi-playlist-check")])),_:1}),(0,o.bF)(y.y,{activator:"parent",location:"bottom"},{default:(0,o.k6)((()=>[(0,o.eW)("Selecionar todos")])),_:1})])),_:1}),Ee])),_:1}),(0,o.bF)(s.O,{class:"scrollable-card"},{default:(0,o.k6)((()=>[n.isLoading?((0,o.uX)(),(0,o.CE)("div",Me,[((0,o.uX)(),(0,o.CE)(o.FK,null,(0,o.pI)(5,(e=>(0,o.bF)(we.V8,{key:e,type:"heading"}))),64))])):((0,o.uX)(),(0,o.CE)("div",Te,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.seriesVariables,(e=>((0,o.uX)(),(0,o.Wv)(D.N,{key:e.seriesvariable_id,modelValue:c.localWStoAdd.seriesvariables,"onUpdate:modelValue":t[1]||(t[1]=e=>c.localWStoAdd.seriesvariables=e),label:e.seriesvariable_longname,value:e,color:"secondary",density:"comfortable","hide-details":""},null,8,["modelValue","label","value"])))),128))]))])),_:1})])),_:1})}var Pe={name:"SeriesProvider",props:{providerSelected:{type:Object},WStoAdd:{type:Object},formValid:{type:Boolean,default:!1}},setup(){const e=(0,C.E)();return{accountStore:e}},data(){return{series:[],seriesVariables:[],isLoading:!1}},watch:{providerSelected:{handler(){this.localWStoAdd.seriesvariables=[]},deep:!0}},computed:{localWStoAdd:{get(){return this.WStoAdd},set(e){this.$emit("update:WStoAdd",e)}},localFormValid:{get(){return this.formValid},set(e){this.$emit("update:formValid",e)}},providerName(){return this.providerSelected.dataprovider_name}},methods:{getSeriesVariables(e){this.isLoading=!0,N.A.request({url:"api/dataprovider/"+e+"/seriesvariables",method:"get",headers:{Authorization:"Bearer "+this.accountStore.account.token}}).then((e=>{this.seriesVariables=e.data,this.isLoading=!1})).catch((e=>{console.log(e),this.isLoading=!1}))},selectAll(){this.localWStoAdd.seriesvariables=this.seriesVariables}},mounted(){this.localWStoAdd.seriesvariables=[],this.getSeriesVariables(this.providerSelected.dataprovider_id)}};const Be=(0,Q.A)(Pe,[["render",De],["__scopeId","data-v-7ebe908c"]]);var je=Be,Xe={name:"AddWeatherStationMap",components:{MapboxMap:Y.ae,SeriesProvider:je},props:{WStoAdd:{type:Object},formValid:{type:Boolean,default:!1},providerSelected:{type:Object,default:()=>({dataprovider_id:0,dataprovider_name:""})},WSfromProvider:{type:Object,default:()=>({type:"FeatureCollection",features:[]})}},setup(){const e=new(te().Popup)({closeButton:!1,closeOnClick:!1}),t="pk.eyJ1IjoibXJiYWlhbyIsImEiOiJjbHlzamJ3NzgwZTF2MmlxdjI1aWFvMDJ3In0.iLJP5hiKMbSd113vFLBRtg";return{popup:e,accessToken:t}},data(){return{map:null,mapCenter:[-9,39],rules:[e=>!!e||"Selecione uma estação",e=>null!==e||"Selecione uma estação"]}},watch:{WStoAdd:{handler:function(e,t){e&&this.map.flyTo({center:e.location,zoom:12})},deep:!0},WSfromProvider:{handler:function(e,t){this.map.getSource("weather-stations-provider")&&this.map.getSource("weather-stations-provider").setData(e)},deep:!0}},computed:{localWStoAdd:{get(){return this.WStoAdd},set(e){this.$emit("update:WStoAdd",e)}},localFormValid:{get(){return this.formValid},set(e){this.$emit("update:formValid",e)}},selectItemsWS(){return this.WSfromProvider.features.map((e=>({displayName:e.properties.datasource_name+" - "+e.properties.datasource_externalId,dataprovider_id:e.properties.dataprovider_id,dataprovider_name:e.properties.dataprovider_name,datasource_externalId:e.properties.datasource_externalId,datasource_name:e.properties.datasource_name,location:e.geometry.coordinates})))}},mounted(){this.map.on("load",(()=>{this.map.addSource("weather-stations-provider",{type:"geojson",data:this.WSfromProvider}),this.map.addLayer({id:"weather-stations-provider",type:"circle",source:"weather-stations-provider",paint:{"circle-radius":6,"circle-color":"#B42222","circle-stroke-width":1,"circle-stroke-color":"#fff"}}),this.map.on("click","weather-stations-provider",(e=>{let t=e.features[0].geometry.coordinates.slice(),a=e.features[0].properties.datasource_externalId,o=e.features[0].properties.datasource_name,r=e.features[0].properties.dataprovider_id,l=e.features[0].properties.dataprovider_name;this.localWStoAdd={displayName:o+" - "+a,dataprovider_id:r,dataprovider_name:l,datasource_externalId:a,datasource_name:o,location:t}})),this.map.on("mouseenter","weather-stations-provider",(e=>{this.map.getCanvas().style.cursor="pointer";let t=e.features[0].geometry.coordinates.slice(),a="<b>Local:</b> "+e.features[0].properties.datasource_name+"<br> <b>ID:</b> "+e.features[0].properties.datasource_externalId;this.popup.setLngLat(t).setHTML(a).addTo(this.map)})),this.map.on("mouseleave","weather-stations-provider",(()=>{this.map.getCanvas().style.cursor="",this.popup.remove()}))}))}};const Oe=(0,Q.A)(Xe,[["render",xe]]);var ze=Oe;const Ue={key:0},Je=(0,o.Lk)("b",null,"Fornecedor:",-1),Ne=(0,o.Lk)("br",null,null,-1),$e=(0,o.Lk)("br",null,null,-1),Qe=(0,o.Lk)("br",null,null,-1),qe=(0,o.Lk)("b",null," Localização: ",-1),Re=(0,o.Lk)("br",null,null,-1),He=(0,o.Lk)("b",null,"Longitude:",-1),Ke=(0,o.Lk)("br",null,null,-1),Ge=(0,o.Lk)("b",null,"Latitude:",-1),Ze=(0,o.Lk)("br",null,null,-1);function Ye(e,t,a,l,i,d){const s=(0,o.g2)("SeriesProvider"),n=(0,o.g2)("MapboxMap");return(0,o.uX)(),(0,o.Wv)(W.i,{width:"65rem"},{default:(0,o.k6)((()=>[i.isLoading?((0,o.uX)(),(0,o.Wv)(c.L,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{class:"d-flex justify-center"},{default:(0,o.k6)((()=>[(0,o.bF)(T.x,{color:"secondary",size:"65",width:"7",indeterminate:""})])),_:1})])),_:1})):0!=d.displayItems.length||i.isLoading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(c.L,{key:1},{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"12"},{default:(0,o.k6)((()=>[0!=d.selectItemsWS.length||i.isLoading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(le.l,{key:0,dense:"",outlined:"",color:"info",icon:"mdi-information-variant",text:""},{default:(0,o.k6)((()=>[(0,o.eW)(" Sem estações disponíveis")])),_:1}))])),_:1})])),_:1})),(0,o.bo)((0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"5"},{default:(0,o.k6)((()=>[(0,o.bF)(W.i,{class:"pa-2 mb-4",border:"",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(M.n,{modelValue:d.localFormValid,"onUpdate:modelValue":t[1]||(t[1]=e=>d.localFormValid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(Se.V,{modelValue:d.localWStoAdd,"onUpdate:modelValue":t[0]||(t[0]=e=>d.localWStoAdd=e),class:"mt-4",label:"Estações disponíveis",variant:"outlined",color:"secondary",items:d.selectItemsWS,"item-title":"displayName",rules:i.rules,"return-object":""},null,8,["modelValue","items","rules"])])),_:1},8,["modelValue"]),null!=d.localWStoAdd?((0,o.uX)(),(0,o.CE)("div",Ue,[(0,o.bF)(E.G),(0,o.bF)(W.i,{class:"mt-4"},{default:(0,o.k6)((()=>[(0,o.Lk)("span",null,[Je,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.dataprovider_name),1)]),Ne,(0,o.Lk)("span",null,[(0,o.Lk)("b",null," Identificador "+(0,S.v_)(d.localWStoAdd.dataprovider_name)+": ",1),(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.datasource_externalId),1)]),$e,Qe,(0,o.Lk)("span",null,[qe,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.datasource_name),1)]),Re,(0,o.Lk)("span",null,[He,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.location[0]),1)]),Ke,(0,o.Lk)("span",null,[Ge,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.location[1]),1)]),Ze])),_:1})])):(0,o.Q3)("",!0)])),_:1}),null!=d.localWStoAdd?((0,o.uX)(),(0,o.Wv)(s,{key:0,providerSelected:a.providerSelected,WStoAdd:d.localWStoAdd,formValid:d.localFormValid,"onUpdate:WStoAdd":t[2]||(t[2]=e=>d.localWStoAdd=e),"onUpdate:formValid":t[3]||(t[3]=e=>d.localFormValid=e)},null,8,["providerSelected","WStoAdd","formValid"])):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)(u.B,{cols:"7"},{default:(0,o.k6)((()=>[(0,o.bF)(W.i,{class:"pa-2",border:"",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{ref:"mapboxMap",accessToken:l.accessToken,mapStyle:"mapbox://styles/mapbox/satellite-streets-v12",onMbCreated:t[4]||(t[4]=e=>i.map=e),center:i.mapCenter,zoom:8,style:{height:"40rem"}},null,8,["accessToken","center"])])),_:1})])),_:1})])),_:1},512),[[r.aG,d.displayItems.length>0&&!i.isLoading]])])),_:1})}var et={name:"AddPESSLWeatherStation",components:{MapboxMap:Y.ae,SeriesProvider:je},props:{WStoAdd:{type:Object},providerSelected:{type:Object,default:()=>({dataprovider_id:0,dataprovider_name:""})},providerAccount:{type:Object},WSfromFitoAgro:{type:Object,default:()=>({type:"FeatureCollection",features:[]})},formValid:{type:Boolean,default:!1}},setup(){const e=(0,C.E)(),t=(0,w.T)(),a=new(te().Popup)({closeButton:!1,closeOnClick:!1}),o="pk.eyJ1IjoibXJiYWlhbyIsImEiOiJjbHlzamJ3NzgwZTF2MmlxdjI1aWFvMDJ3In0.iLJP5hiKMbSd113vFLBRtg";return{accountStore:e,generalStore:t,popup:a,accessToken:o}},data(){return{isLoading:!0,map:null,mapCenter:[-9,39],rules:[e=>!!e||"Selecione uma estação",e=>null!==e||"Selecione uma estação"],WSfromPESSL:[]}},watch:{localWStoAdd:{handler:function(e,t){e&&this.map.flyTo({center:e.location,zoom:12})},deep:!0},providerAccount:{handler:function(e,t){this.recenterMap(),e&&this.getPESSLWeatherStations()}}},computed:{localWStoAdd:{get(){return this.WStoAdd},set(e){this.$emit("update:WStoAdd",e)}},localFormValid:{get(){return this.formValid},set(e){this.$emit("update:formValid",e)}},displayItems(){return this.WSfromPESSL.filter((e=>!this.WSfromFitoAgro.features.some((t=>t.properties.datasource_externalId===e.datasource_externalId))))},mapItems(){return{type:"FeatureCollection",features:this.displayItems.map((e=>({type:"Feature",geometry:e.geometry,properties:{datasource_name:e.datasource_name,datasource_externalId:e.datasource_externalId,dataprovider_id:e.dataprovider_id,dataprovider_name:e.dataprovider_name}})))}},selectItemsWS(){return this.displayItems.map((e=>({displayName:e.datasource_name+" - "+e.datasource_externalId,dataprovider_id:e.dataprovider_id,dataprovider_name:e.dataprovider_name,datasource_externalId:e.datasource_externalId,datasource_name:e.datasource_name,location:e.geometry.coordinates})))}},methods:{async getPESSLWeatherStations(){this.isLoading=!0,N.A.request({url:"api/pessl/"+this.providerAccount.agent_id+"/stations",method:"get",headers:{Authorization:"Bearer "+this.accountStore.account.token}}).then((e=>{this.WSfromPESSL=e.data.map((e=>({geometry:e.position.geo,datasource_name:e.name.custom,datasource_externalId:e.name.original,dataprovider_id:this.providerSelected.dataprovider_id,dataprovider_name:this.providerSelected.dataprovider_name}))),this.reloadMapLayer(),this.isLoading=!1})).catch((e=>{console.log(e),this.isLoading=!1,this.generalStore.errorSnackbar("Erro ao buscar Estações da conta PESSL!")}))},reloadMapLayer(){this.map.getSource("weather-stations-provider").setData(this.mapItems)},recenterMap(){this.map.setCenter(this.mapCenter),this.map.setZoom(8)}},mounted(){this.map.on("load",(()=>{this.map.addSource("weather-stations-provider",{type:"geojson",data:this.mapItems}),this.map.addLayer({id:"weather-stations-provider",type:"circle",source:"weather-stations-provider",paint:{"circle-radius":6,"circle-color":"#B42222","circle-stroke-width":1,"circle-stroke-color":"#fff"}}),this.map.on("click","weather-stations-provider",(e=>{let t=e.features[0].geometry.coordinates.slice(),a=e.features[0].properties.datasource_externalId,o=e.features[0].properties.datasource_name,r=e.features[0].properties.dataprovider_id,l=e.features[0].properties.dataprovider_name;this.localWStoAdd={displayName:o+" - "+a,dataprovider_id:r,dataprovider_name:l,datasource_externalId:a,datasource_name:o,location:t}})),this.map.on("mouseenter","weather-stations-provider",(e=>{this.map.getCanvas().style.cursor="pointer";let t=e.features[0].geometry.coordinates.slice(),a="<b>Local:</b> "+e.features[0].properties.datasource_name+"<br> <b>ID:</b> "+e.features[0].properties.datasource_externalId;this.popup.setLngLat(t).setHTML(a).addTo(this.map)})),this.map.on("mouseleave","weather-stations-provider",(()=>{this.map.getCanvas().style.cursor="",this.popup.remove()})),this.providerAccount&&this.getPESSLWeatherStations()}))}};const tt=(0,Q.A)(et,[["render",Ye]]);var at=tt;function ot(e,t,a,r,l,i){const d=(0,o.g2)("SeriesProvider");return(0,o.uX)(),(0,o.Wv)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"12",class:"d-flex justify-center"},{default:(0,o.k6)((()=>[0!=i.selectItemsWS.length||l.isLoading?((0,o.uX)(),(0,o.Wv)(W.i,{key:1,rounded:"",border:"",class:"pa-5",width:"35rem"},{default:(0,o.k6)((()=>[(0,o.bF)(M.n,{modelValue:i.localFormValid,"onUpdate:modelValue":t[1]||(t[1]=e=>i.localFormValid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(Se.V,{modelValue:i.localWStoAdd,"onUpdate:modelValue":t[0]||(t[0]=e=>i.localWStoAdd=e),class:"mt-4",label:"Estações disponíveis",variant:"outlined",density:"compact",color:"secondary",items:i.selectItemsWS,loading:l.isLoading,"item-title":"datasource_name",rules:l.rules,"return-object":""},null,8,["modelValue","items","loading","rules"])])),_:1},8,["modelValue"])])),_:1})):((0,o.uX)(),(0,o.Wv)(le.l,{key:0,dense:"",outlined:"",color:"info",icon:"mdi-information-variant",text:""},{default:(0,o.k6)((()=>[(0,o.eW)(" Sem novas estações")])),_:1}))])),_:1}),(0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"12"},{default:(0,o.k6)((()=>[null!=i.localWStoAdd?((0,o.uX)(),(0,o.Wv)(d,{key:0,providerSelected:a.providerSelected,WStoAdd:i.localWStoAdd,formValid:i.localFormValid,"onUpdate:WStoAdd":t[2]||(t[2]=e=>i.localWStoAdd=e),"onUpdate:formValid":t[3]||(t[3]=e=>i.localFormValid=e)},null,8,["providerSelected","WStoAdd","formValid"])):(0,o.Q3)("",!0)])),_:1})])),_:1})])),_:1})}var rt={name:"AddAPASWeatherStation",components:{SeriesProvider:je},props:{WStoAdd:{type:Object},providerSelected:{type:Object,default:()=>({dataprovider_id:0,dataprovider_name:""})},providerAccount:{type:Object},WSfromFitoAgro:{type:Object,default:()=>({type:"FeatureCollection",features:[]})},formValid:{type:Boolean,default:!1}},setup(){const e=(0,w.T)(),t=(0,C.E)();return{generalStore:e,accountStore:t}},data(){return{isLoading:!1,WSfromAPAS:[],rules:[e=>!!e||"Seleciona uma estação"]}},watch:{providerAccount:{handler:function(e,t){e&&this.getAPASWeatherStations()}}},computed:{localWStoAdd:{get(){return this.WStoAdd},set(e){this.$emit("update:WStoAdd",e)}},localFormValid:{get(){return this.formValid},set(e){this.$emit("update:formValid",e)}},selectItemsWS(){return this.WSfromAPAS.filter((e=>!this.WSfromFitoAgro.features.some((t=>t.properties.datasource_externalId===e.datasource_externalId))))}},methods:{async getAPASWeatherStations(){N.A.request({url:"api/apas/"+this.providerAccount.agent_id+"/stations",method:"get",headers:{Authorization:"Bearer "+this.accountStore.account.token}}).then((e=>{this.WSfromAPAS=e.data.entries.map((e=>({dataprovider_id:this.providerSelected.dataprovider_id,dataprovider_name:this.providerSelected.dataprovider_name,datasource_externalId:e.name,datasource_name:e.name}))),this.isLoading=!1})).catch((e=>{console.log(e),this.isLoading=!1,this.generalStore.errorSnackbar("Erro ao obter estações da conta APAS")}))}},mounted(){this.providerAccount&&this.getAPASWeatherStations()}};const lt=(0,Q.A)(rt,[["render",ot]]);var it=lt;const dt={key:0},st=(0,o.Lk)("b",null,"Fornecedor:",-1),nt=(0,o.Lk)("br",null,null,-1),ct=(0,o.Lk)("br",null,null,-1),ut=(0,o.Lk)("br",null,null,-1),pt=(0,o.Lk)("b",null," Localização: ",-1),mt=(0,o.Lk)("br",null,null,-1),ht=(0,o.Lk)("b",null,"Longitude:",-1),vt=(0,o.Lk)("br",null,null,-1),ft=(0,o.Lk)("b",null,"Latitude:",-1),St=(0,o.Lk)("br",null,null,-1);function bt(e,t,a,l,i,d){const s=(0,o.g2)("SeriesProvider"),n=(0,o.g2)("MapboxMap");return(0,o.uX)(),(0,o.Wv)(W.i,{width:"65rem"},{default:(0,o.k6)((()=>[i.isLoading?((0,o.uX)(),(0,o.Wv)(c.L,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{class:"d-flex justify-center"},{default:(0,o.k6)((()=>[(0,o.bF)(T.x,{color:"secondary",size:"65",width:"7",indeterminate:""})])),_:1})])),_:1})):0!=d.displayItems.length||i.isLoading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(c.L,{key:1},{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"12"},{default:(0,o.k6)((()=>[0!=d.selectItemsWS.length||i.isLoading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(le.l,{key:0,dense:"",outlined:"",color:"info",icon:"mdi-information-variant",border:"left",text:""},{default:(0,o.k6)((()=>[(0,o.eW)(" Sem estações disponíveis")])),_:1}))])),_:1})])),_:1})),(0,o.bo)((0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"5"},{default:(0,o.k6)((()=>[(0,o.bF)(W.i,{class:"pa-2 mb-4",border:"",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(M.n,{modelValue:d.localFormValid,"onUpdate:modelValue":t[1]||(t[1]=e=>d.localFormValid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(Se.V,{modelValue:d.localWStoAdd,"onUpdate:modelValue":t[0]||(t[0]=e=>d.localWStoAdd=e),class:"mt-4",label:"Estações disponíveis",placeholder:"Selecione uma estação","no-data-text":"Sem resultados",variant:"outlined",items:d.selectItemsWS,"item-title":"displayName",rules:i.rules,"return-object":""},null,8,["modelValue","items","rules"])])),_:1},8,["modelValue"]),null!=d.localWStoAdd?((0,o.uX)(),(0,o.CE)("div",dt,[(0,o.bF)(E.G),(0,o.bF)(W.i,{class:"mt-4"},{default:(0,o.k6)((()=>[(0,o.Lk)("span",null,[st,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.dataprovider_name),1)]),nt,(0,o.Lk)("span",null,[(0,o.Lk)("b",null," Identificador "+(0,S.v_)(d.localWStoAdd.dataprovider_name)+": ",1),(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.datasource_externalId),1)]),ct,ut,(0,o.Lk)("span",null,[pt,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.datasource_name),1)]),mt,(0,o.Lk)("span",null,[ht,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.location[0]),1)]),vt,(0,o.Lk)("span",null,[ft,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.location[1]),1)]),St])),_:1})])):(0,o.Q3)("",!0)])),_:1}),null!=d.localWStoAdd?((0,o.uX)(),(0,o.Wv)(s,{key:0,providerSelected:a.providerSelected,WStoAdd:d.localWStoAdd,formValid:d.localFormValid,"onUpdate:WStoAdd":t[2]||(t[2]=e=>d.localWStoAdd=e),"onUpdate:formValid":t[3]||(t[3]=e=>d.localFormValid=e)},null,8,["providerSelected","WStoAdd","formValid"])):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)(u.B,{cols:"7"},{default:(0,o.k6)((()=>[(0,o.bF)(W.i,{class:"pa-2",border:"",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{ref:"mapboxMap",accessToken:l.accessToken,mapStyle:"mapbox://styles/mapbox/satellite-streets-v12",onMbCreated:t[4]||(t[4]=e=>i.map=e),center:i.mapCenter,zoom:8,style:{height:"40rem"}},null,8,["accessToken","center"])])),_:1})])),_:1})])),_:1},512),[[r.aG,d.displayItems.length>0&&!i.isLoading]])])),_:1})}var _t={name:"AddIPMAWeatherStation",components:{MapboxMap:Y.ae,SeriesProvider:je},props:{WStoAdd:{type:Object},providerSelected:{type:Object,default:()=>({dataprovider_id:0,dataprovider_name:""})},WSfromFitoAgro:{type:Object,default:()=>({type:"FeatureCollection",features:[]})},formValid:{type:Boolean,default:!1}},setup(){const e=(0,w.T)(),t=new(te().Popup)({closeButton:!1,closeOnClick:!1}),a="pk.eyJ1IjoibXJiYWlhbyIsImEiOiJjbHlzamJ3NzgwZTF2MmlxdjI1aWFvMDJ3In0.iLJP5hiKMbSd113vFLBRtg";return{popup:t,generalStore:e,accessToken:a}},data(){return{isLoading:!0,map:null,mapCenter:[-9,39],rules:[e=>!!e||"Selecione uma estação",e=>null!==e||"Selecione uma estação"],WSfromIPMA:[]}},watch:{localWStoAdd:{handler:function(e,t){e&&this.map.flyTo({center:e.location,zoom:12})},deep:!0}},computed:{localWStoAdd:{get(){return this.WStoAdd},set(e){this.$emit("update:WStoAdd",e)}},localFormValid:{get(){return this.formValid},set(e){this.$emit("update:formValid",e)}},displayItems(){return this.WSfromIPMA.filter((e=>!this.WSfromFitoAgro.features.some((t=>parseInt(t.properties.datasource_externalId)===parseInt(e.datasource_externalId)))))},mapItems(){return{type:"FeatureCollection",features:this.displayItems.map((e=>({type:"Feature",geometry:e.geometry,properties:{datasource_name:e.datasource_name,datasource_externalId:e.datasource_externalId,dataprovider_id:e.dataprovider_id,dataprovider_name:e.dataprovider_name}})))}},selectItemsWS(){return this.displayItems.map((e=>({displayName:e.datasource_name+" - "+e.datasource_externalId,dataprovider_id:e.dataprovider_id,dataprovider_name:e.dataprovider_name,datasource_externalId:e.datasource_externalId,datasource_name:e.datasource_name,location:e.geometry.coordinates})))}},methods:{async getIPMAStations(){N.A.get("https://api.ipma.pt/open-data/observation/meteorology/stations/stations.json").then((e=>{this.WSfromIPMA=e.data.map((e=>({geometry:e.geometry,datasource_name:e.properties.localEstacao,datasource_externalId:e.properties.idEstacao,dataprovider_id:this.providerSelected.dataprovider_id,dataprovider_name:this.providerSelected.dataprovider_name}))),this.reloadMapLayer(),this.isLoading=!1})).catch((e=>{console.log(e),this.isLoading=!1,this.generalStore.errorSnackbar("Erro ao buscar Estações IPMA!")}))},reloadMapLayer(){this.map.getSource("weather-stations-provider").setData(this.mapItems)}},mounted(){this.map.on("load",(()=>{this.map.addSource("weather-stations-provider",{type:"geojson",data:this.mapItems}),this.map.addLayer({id:"weather-stations-provider",type:"circle",source:"weather-stations-provider",paint:{"circle-radius":6,"circle-color":"#B42222","circle-stroke-width":1,"circle-stroke-color":"#fff"}}),this.map.on("click","weather-stations-provider",(e=>{let t=e.features[0].geometry.coordinates.slice(),a=e.features[0].properties.datasource_externalId,o=e.features[0].properties.datasource_name,r=e.features[0].properties.dataprovider_id,l=e.features[0].properties.dataprovider_name;this.localWStoAdd={displayName:o+" - "+a,dataprovider_id:r,dataprovider_name:l,datasource_externalId:a,datasource_name:o,location:t}})),this.map.on("mouseenter","weather-stations-provider",(e=>{this.map.getCanvas().style.cursor="pointer";let t=e.features[0].geometry.coordinates.slice(),a="<b>Local:</b> "+e.features[0].properties.datasource_name+"<br> <b>ID:</b> "+e.features[0].properties.datasource_externalId;this.popup.setLngLat(t).setHTML(a).addTo(this.map)})),this.map.on("mouseleave","weather-stations-provider",(()=>{this.map.getCanvas().style.cursor="",this.popup.remove()})),this.getIPMAStations()}))}};const gt=(0,Q.A)(_t,[["render",bt]]);var kt=gt;const Wt={key:0},yt=(0,o.Lk)("b",null,"Fornecedor:",-1),Ft=(0,o.Lk)("br",null,null,-1),At=(0,o.Lk)("br",null,null,-1),Lt=(0,o.Lk)("br",null,null,-1),Vt=(0,o.Lk)("b",null," Nome da Estação: ",-1),It=(0,o.Lk)("br",null,null,-1),xt=(0,o.Lk)("b",null,"Longitude:",-1),wt=(0,o.Lk)("br",null,null,-1),Ct=(0,o.Lk)("b",null,"Latitude:",-1),Et=(0,o.Lk)("br",null,null,-1);function Mt(e,t,a,l,i,d){const s=(0,o.g2)("SeriesProvider"),n=(0,o.g2)("MapboxMap");return(0,o.uX)(),(0,o.Wv)(W.i,{width:"65rem"},{default:(0,o.k6)((()=>[i.isLoading?((0,o.uX)(),(0,o.Wv)(c.L,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{class:"d-flex justify-center"},{default:(0,o.k6)((()=>[(0,o.bF)(T.x,{color:"secondary",size:"65",width:"7",indeterminate:""})])),_:1})])),_:1})):0!=d.displayItems.length||i.isLoading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(c.L,{key:1},{default:(0,o.k6)((()=>[(0,o.bF)(u.B,null,{default:(0,o.k6)((()=>[(0,o.bF)(le.l,{dense:"",outlined:"",color:"info",icon:"mdi-information-variant",text:""},{default:(0,o.k6)((()=>[(0,o.eW)(" Sem estações disponíveis")])),_:1})])),_:1})])),_:1})),(0,o.bo)((0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"5"},{default:(0,o.k6)((()=>[(0,o.bF)(W.i,{class:"pa-2 mb-4",border:"",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(M.n,{modelValue:d.localFormValid,"onUpdate:modelValue":t[1]||(t[1]=e=>d.localFormValid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(Se.V,{modelValue:d.localWStoAdd,"onUpdate:modelValue":t[0]||(t[0]=e=>d.localWStoAdd=e),class:"mt-4",label:"Estações disponíveis",variant:"outlined",color:"secondary",items:d.selectItems,"item-title":"displayName",rules:i.rules,"return-object":""},null,8,["modelValue","items","rules"])])),_:1},8,["modelValue"]),null!=d.localWStoAdd?((0,o.uX)(),(0,o.CE)("div",Wt,[(0,o.bF)(E.G),(0,o.bF)(W.i,{class:"mt-4"},{default:(0,o.k6)((()=>[(0,o.Lk)("span",null,[yt,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.dataprovider_name),1)]),Ft,(0,o.Lk)("span",null,[(0,o.Lk)("b",null," Identificador "+(0,S.v_)(d.localWStoAdd.dataprovider_name)+": ",1),(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.datasource_externalId),1)]),At,Lt,(0,o.Lk)("span",null,[Vt,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.datasource_name),1)]),It,(0,o.Lk)("span",null,[xt,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.location[0]),1)]),wt,(0,o.Lk)("span",null,[Ct,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.location[1]),1)]),Et])),_:1})])):(0,o.Q3)("",!0)])),_:1}),null!=d.localWStoAdd?((0,o.uX)(),(0,o.Wv)(s,{key:0,providerSelected:a.provider,WStoAdd:d.localWStoAdd,formValid:d.localFormValid,"onUpdate:WStoAdd":t[2]||(t[2]=e=>d.localWStoAdd=e),"onUpdate:formValid":t[3]||(t[3]=e=>d.localFormValid=e)},null,8,["providerSelected","WStoAdd","formValid"])):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)(u.B,{cols:"7"},{default:(0,o.k6)((()=>[(0,o.bF)(W.i,{class:"pa-2",border:"",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{ref:"mapboxMap",accessToken:l.accessToken,mapStyle:"mapbox://styles/mapbox/satellite-streets-v12",onMbCreated:t[4]||(t[4]=e=>i.map=e),center:i.mapCenter,zoom:8,style:{height:"40rem"}},null,8,["accessToken","center"])])),_:1})])),_:1})])),_:1},512),[[r.aG,d.displayItems.length>0&&!i.isLoading]])])),_:1})}var Tt={name:"AddWisecropWeatherStation",components:{SeriesProvider:je,MapboxMap:Y.ae},props:{WStoAdd:{type:Object},provider:{type:Object},providerAccount:{type:Object},WSfromFitoAgro:{type:Object,default:()=>({type:"FeatureCollection",features:[]})},formValid:{type:Boolean,default:!1}},setup(){const e=(0,C.E)(),t=(0,w.T)(),a=new(te().Popup)({closeButton:!1,closeOnClick:!1}),o="pk.eyJ1IjoibXJiYWlhbyIsImEiOiJjbHlzamJ3NzgwZTF2MmlxdjI1aWFvMDJ3In0.iLJP5hiKMbSd113vFLBRtg";return{accountStore:e,generalStore:t,popup:a,accessToken:o}},data(){return{isLoading:!0,map:null,mapCenter:[-9,39],rules:[e=>!!e||"Selecione uma estação",e=>null!==e||"Selecione uma estação"],WSfromWisecrop:[]}},watch:{localWStoAdd:{handler:function(e,t){e&&this.map.flyTo({center:e.location,zoom:12})},deep:!0},providerAccount:{handler:function(e,t){this.recenterMap(),e&&this.getWisecropWeatherStations()}}},computed:{localWStoAdd:{get(){return this.WStoAdd},set(e){this.$emit("update:WStoAdd",e)}},localFormValid:{get(){return this.formValid},set(e){this.$emit("update:formValid",e)}},displayItems(){return this.WSfromWisecrop.filter((e=>!this.WSfromFitoAgro.features.some((t=>t.properties.datasource_externalId===e.datasource_externalId))))},mapItems(){return{type:"FeatureCollection",features:this.displayItems.map((e=>({type:"Feature",geometry:e.geometry,properties:{datasource_name:e.datasource_name,datasource_externalId:e.datasource_externalId,dataprovider_id:e.dataprovider_id,dataprovider_name:e.dataprovider_name}})))}},selectItems(){return this.displayItems.map((e=>({displayName:e.datasource_name+" - "+e.datasource_externalId,dataprovider_id:e.dataprovider_id,dataprovider_name:e.dataprovider_name,datasource_externalId:e.datasource_externalId,datasource_name:e.datasource_name,location:e.geometry.coordinates})))}},methods:{async getWisecropWeatherStations(){this.isLoading=!0,await N.A.request({url:"api/wisecrop/"+this.providerAccount.agent_id+"/stations",method:"GET",headers:{Authorization:"Bearer "+this.accountStore.account.token}}).then((e=>{console.log(e.data),this.WSfromWisecrop=e.data.map((e=>({geometry:{type:"Point",coordinates:e.coords},datasource_name:e.name,datasource_externalId:e.id,dataprovider_id:this.provider.dataprovider_id,dataprovider_name:this.provider.dataprovider_name}))),this.reloadMapLayer(),this.isLoading=!1})).catch((e=>{console.log(e),this.isLoading=!1,this.generalStore.errorSnackbar("Erro ao buscar Estações da conta WiseCrop!")}))},reloadMapLayer(){this.map.getSource("weather-stations-provider").setData(this.mapItems)},recenterMap(){this.map.setCenter(this.mapCenter),this.map.setZoom(8)}},mounted(){this.map.on("load",(()=>{this.map.addSource("weather-stations-provider",{type:"geojson",data:this.mapItems}),this.map.addLayer({id:"weather-stations-provider",type:"circle",source:"weather-stations-provider",paint:{"circle-radius":6,"circle-color":"#B42222","circle-stroke-width":1,"circle-stroke-color":"#fff"}}),this.map.on("click","weather-stations-provider",(e=>{let t=e.features[0].geometry.coordinates.slice(),a=e.features[0].properties.datasource_externalId,o=e.features[0].properties.datasource_name,r=e.features[0].properties.dataprovider_id,l=e.features[0].properties.dataprovider_name;this.localWStoAdd={displayName:o+" - "+a,dataprovider_id:r,dataprovider_name:l,datasource_externalId:a,datasource_name:o,location:t}})),this.map.on("mouseenter","weather-stations-provider",(e=>{this.map.getCanvas().style.cursor="pointer";let t=e.features[0].geometry.coordinates.slice(),a="<b>Local:</b> "+e.features[0].properties.datasource_name+"<br> <b>ID:</b> "+e.features[0].properties.datasource_externalId;this.popup.setLngLat(t).setHTML(a).addTo(this.map)})),this.map.on("mouseleave","weather-stations-provider",(()=>{this.map.getCanvas().style.cursor="",this.popup.remove()})),this.providerAccount&&this.getWisecropWeatherStations()}))}};const Dt=(0,Q.A)(Tt,[["render",Mt]]);var Pt=Dt;const Bt={key:0},jt=(0,o.Lk)("b",null,"Fornecedor:",-1),Xt=(0,o.Lk)("br",null,null,-1),Ot=(0,o.Lk)("br",null,null,-1),zt=(0,o.Lk)("br",null,null,-1),Ut=(0,o.Lk)("b",null," Nome da Estação: ",-1),Jt=(0,o.Lk)("br",null,null,-1),Nt=(0,o.Lk)("b",null,"Longitude:",-1),$t=(0,o.Lk)("br",null,null,-1),Qt=(0,o.Lk)("b",null,"Latitude:",-1),qt=(0,o.Lk)("br",null,null,-1);function Rt(e,t,a,l,i,d){const s=(0,o.g2)("SeriesProvider"),n=(0,o.g2)("MapboxMap");return(0,o.uX)(),(0,o.Wv)(W.i,{width:"65rem"},{default:(0,o.k6)((()=>[i.isLoading?((0,o.uX)(),(0,o.Wv)(c.L,{key:0},{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{class:"d-flex justify-center"},{default:(0,o.k6)((()=>[(0,o.bF)(T.x,{color:"secondary",size:"65",width:"7",indeterminate:""})])),_:1})])),_:1})):0!=d.displayItems.length||i.isLoading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(c.L,{key:1},{default:(0,o.k6)((()=>[(0,o.bF)(u.B,null,{default:(0,o.k6)((()=>[(0,o.bF)(le.l,{dense:"",outlined:"",color:"info",icon:"mdi-information-variant",text:""},{default:(0,o.k6)((()=>[(0,o.eW)(" Sem estações disponíveis")])),_:1})])),_:1})])),_:1})),(0,o.bo)((0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"5"},{default:(0,o.k6)((()=>[(0,o.bF)(W.i,{class:"pa-2 mb-4",border:"",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(M.n,{modelValue:d.localFormValid,"onUpdate:modelValue":t[1]||(t[1]=e=>d.localFormValid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(Se.V,{modelValue:d.localWStoAdd,"onUpdate:modelValue":t[0]||(t[0]=e=>d.localWStoAdd=e),class:"mt-4",label:"Estações disponíveis",variant:"outlined",color:"secondary",items:d.selectItems,"item-title":"displayName",rules:i.rules,"return-object":""},null,8,["modelValue","items","rules"])])),_:1},8,["modelValue"]),null!=d.localWStoAdd?((0,o.uX)(),(0,o.CE)("div",Bt,[(0,o.bF)(E.G),(0,o.bF)(W.i,{class:"mt-4"},{default:(0,o.k6)((()=>[(0,o.Lk)("span",null,[jt,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.dataprovider_name),1)]),Xt,(0,o.Lk)("span",null,[(0,o.Lk)("b",null," Identificador "+(0,S.v_)(d.localWStoAdd.dataprovider_name)+": ",1),(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.datasource_externalId),1)]),Ot,zt,(0,o.Lk)("span",null,[Ut,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.datasource_name),1)]),Jt,(0,o.Lk)("span",null,[Nt,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.location[0]),1)]),$t,(0,o.Lk)("span",null,[Qt,(0,o.eW)(" "+(0,S.v_)(d.localWStoAdd.location[1]),1)]),qt])),_:1})])):(0,o.Q3)("",!0)])),_:1}),null!=d.localWStoAdd?((0,o.uX)(),(0,o.Wv)(s,{key:0,providerSelected:a.provider,WStoAdd:d.localWStoAdd,formValid:d.localFormValid,"onUpdate:WStoAdd":t[2]||(t[2]=e=>d.localWStoAdd=e),"onUpdate:formValid":t[3]||(t[3]=e=>d.localFormValid=e)},null,8,["providerSelected","WStoAdd","formValid"])):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)(u.B,{cols:"7"},{default:(0,o.k6)((()=>[(0,o.bF)(W.i,{class:"pa-2",border:"",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{ref:"mapboxMap",accessToken:l.accessToken,mapStyle:"mapbox://styles/mapbox/satellite-streets-v12",onMbCreated:t[4]||(t[4]=e=>i.map=e),center:i.mapCenter,zoom:8,style:{height:"40rem"}},null,8,["accessToken","center"])])),_:1})])),_:1})])),_:1},512),[[r.aG,d.displayItems.length>0&&!i.isLoading]])])),_:1})}var Ht={name:"AddTerraproWeatherStation",components:{SeriesProvider:je,MapboxMap:Y.ae},props:{WStoAdd:{type:Object},provider:{type:Object},providerAccount:{type:Object},WSfromFitoAgro:{type:Object,default:()=>({type:"FeatureCollection",features:[]})},formValid:{type:Boolean,default:!1}},setup(){const e=(0,C.E)(),t=(0,w.T)(),a=new(te().Popup)({closeButton:!1,closeOnClick:!1}),o="pk.eyJ1IjoibXJiYWlhbyIsImEiOiJjbHlzamJ3NzgwZTF2MmlxdjI1aWFvMDJ3In0.iLJP5hiKMbSd113vFLBRtg";return{accountStore:e,generalStore:t,popup:a,accessToken:o}},data(){return{isLoading:!0,map:null,mapCenter:[-9,39],rules:[e=>!!e||"Selecione uma estação",e=>null!==e||"Selecione uma estação"],WSfromTerrapro:[]}},watch:{localWStoAdd:{handler:function(e,t){e&&this.map.flyTo({center:e.location,zoom:12})},deep:!0},providerAccount:{handler:function(e,t){this.recenterMap(),e&&this.getTerraproWeatherStations()}}},computed:{localWStoAdd:{get(){return this.WStoAdd},set(e){this.$emit("update:WStoAdd",e)}},localFormValid:{get(){return this.formValid},set(e){this.$emit("update:formValid",e)}},displayItems(){return this.WSfromTerrapro.filter((e=>!this.WSfromFitoAgro.features.some((t=>t.properties.datasource_externalId===e.datasource_externalId))))},mapItems(){return{type:"FeatureCollection",features:this.displayItems.map((e=>({type:"Feature",geometry:e.geometry,properties:{datasource_name:e.datasource_name,datasource_externalId:e.datasource_externalId,dataprovider_id:e.dataprovider_id,dataprovider_name:e.dataprovider_name}})))}},selectItems(){return this.displayItems.map((e=>({displayName:e.datasource_name+" - "+e.datasource_externalId,dataprovider_id:e.dataprovider_id,dataprovider_name:e.dataprovider_name,datasource_externalId:e.datasource_externalId,datasource_name:e.datasource_name,location:e.geometry.coordinates})))}},methods:{async getTerraproWeatherStations(){this.isLoading=!0,N.A.request({url:"api/terrapro/"+this.providerAccount.agent_id+"/stations",method:"get",headers:{Authorization:"Bearer "+this.accountStore.account.token}}).then((e=>{this.WSfromTerrapro=e.data.map((e=>({geometry:{type:"Point",coordinates:e.location},datasource_name:e.stationName,datasource_externalId:e.stationID,dataprovider_id:this.provider.dataprovider_id,dataprovider_name:this.provider.dataprovider_name}))),this.reloadMapLayer(),this.isLoading=!1})).catch((e=>{console.log(e),this.isLoading=!1,this.generalStore.errorSnackbar("Erro ao buscar Estações da conta TerraPro!")}))},reloadMapLayer(){this.map.getSource("weather-stations-provider").setData(this.mapItems)},recenterMap(){this.map.setCenter(this.mapCenter),this.map.setZoom(8)}},mounted(){this.map.on("load",(()=>{this.map.addSource("weather-stations-provider",{type:"geojson",data:this.mapItems}),this.map.addLayer({id:"weather-stations-provider",type:"circle",source:"weather-stations-provider",paint:{"circle-radius":6,"circle-color":"#B42222","circle-stroke-width":1,"circle-stroke-color":"#fff"}}),this.map.on("click","weather-stations-provider",(e=>{let t=e.features[0].geometry.coordinates.slice(),a=e.features[0].properties.datasource_externalId,o=e.features[0].properties.datasource_name,r=e.features[0].properties.dataprovider_id,l=e.features[0].properties.dataprovider_name;this.localWStoAdd={displayName:o+" - "+a,dataprovider_id:r,dataprovider_name:l,datasource_externalId:a,datasource_name:o,location:t}})),this.map.on("mouseenter","weather-stations-provider",(e=>{this.map.getCanvas().style.cursor="pointer";let t=e.features[0].geometry.coordinates.slice(),a="<b>Local:</b> "+e.features[0].properties.datasource_name+"<br> <b>ID:</b> "+e.features[0].properties.datasource_externalId;this.popup.setLngLat(t).setHTML(a).addTo(this.map)})),this.map.on("mouseleave","weather-stations-provider",(()=>{this.map.getCanvas().style.cursor="",this.popup.remove()})),this.providerAccount&&this.getTerraproWeatherStations()}))}};const Kt=(0,Q.A)(Ht,[["render",Rt]]);var Gt=Kt,Zt=a(2164),Yt=a(7254);function ea(e,t,a,r,l,n){return(0,o.uX)(),(0,o.Wv)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"12",class:"d-flex justify-center"},{default:(0,o.k6)((()=>[n.localStation?((0,o.uX)(),(0,o.Wv)(W.i,{key:0,rounded:"",border:"",class:"pa-5",width:"35rem"},{default:(0,o.k6)((()=>[(0,o.bF)(M.n,{ref:"form",modelValue:n.localFormValid,"onUpdate:modelValue":t[3]||(t[3]=e=>n.localFormValid=e)},{default:(0,o.k6)((()=>[(0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(v.W,{modelValue:n.localStation.datasource_name,"onUpdate:modelValue":t[0]||(t[0]=e=>n.localStation.datasource_name=e),modelModifiers:{trim:!0},rules:l.rules.name,label:"Nome da Estação","prepend-icon":"mdi-pencil",density:"compact",variant:"outlined"},null,8,["modelValue","rules"])])),_:1})])),_:1}),(0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"6"},{default:(0,o.k6)((()=>[(0,o.bF)(v.W,{modelValue:n.localStation.dataprovider_name,"onUpdate:modelValue":t[1]||(t[1]=e=>n.localStation.dataprovider_name=e),readonly:"",label:"Fornecedor","prepend-icon":"mdi-domain",density:"compact",variant:"outlined"},null,8,["modelValue"])])),_:1}),(0,o.bF)(u.B,{cols:"6"},{default:(0,o.k6)((()=>[(0,o.bF)(v.W,{modelValue:n.localStation.datasource_externalId,"onUpdate:modelValue":t[2]||(t[2]=e=>n.localStation.datasource_externalId=e),readonly:"",label:"Identificador de Fornecedor","prepend-icon":"mdi-identifier",density:"compact",variant:"outlined"},null,8,["modelValue"])])),_:1})])),_:1}),(0,o.bF)(c.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(u.B,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(i.J,{class:"pa-2",elevation:"0",border:"",rounded:"lg"},{default:(0,o.k6)((()=>[(0,o.bF)(d.r,null,{default:(0,o.k6)((()=>[(0,o.eW)("Informação a recolher")])),_:1}),(0,o.bF)(s.O,{class:"scrollable-card"},{default:(0,o.k6)((()=>[(0,o.bF)(Zt.x8,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.localStation.seriesvariables,(e=>((0,o.uX)(),(0,o.Wv)(Yt.g,{key:e.seriesvariable_id,title:e.seriesvariable_longname},null,8,["title"])))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})):((0,o.uX)(),(0,o.Wv)(le.l,{key:1,dense:"",outlined:"",color:"info",icon:"mdi-information-variant",text:""},{default:(0,o.k6)((()=>[(0,o.eW)(" Sem estação selecionada")])),_:1}))])),_:1})])),_:1})}var ta={name:"WSForm",props:{station:{type:Object},formValid:{type:Boolean,default:!1}},data(){return{rules:{name:[e=>!!e||"Insira o nome da estação",e=>e.length<=50||"O nome da estação deve ter menos de 50 caracteres"]}}},computed:{localStation:{get(){return this.station},set(e){this.$emit("update:station",e)}},localFormValid:{get(){return this.formValid},set(e){this.$emit("update:formValid",e)}}}};const aa=(0,Q.A)(ta,[["render",ea],["__scopeId","data-v-33a0821e"]]);var oa=aa,ra=a(144),la={name:"AddWeatherStation",components:{AddWeatherStationMap:ze,AddPESSLWeatherStation:at,AddAPASWeatherStation:it,AddIPMAWeatherStation:kt,AddWisecropWeatherStation:Pt,AddTerraproWeatherStation:Gt,WSForm:oa},setup(){const e=(0,C.E)(),t=x(),a=(0,w.T)(),o=(0,ra.KR)(null);return{accountStore:e,weatherStore:t,generalStore:a,stepper:o}},data(){return{currStep:1,providerSelected:null,providerAccSelected:null,WStoAdd:null,steps:[{title:"Fornecedor",rules:{provider:[e=>!!e||"Selecione um fornecedor"],proAcc:[e=>!!e||"Selecione uma conta"]},formValid:!1},{title:"Estações do Fornecedor",formValid:!1},{title:"Estação a Adicionar",formValid:!1}],needsAccount:!1,loadingAccounts:!1,providerAccounts:[],WSfromFitoagro:{type:"FeatureCollection",features:[]},WSfromProvider:{type:"FeatureCollection",features:[]},map:null,mapCenter:[-9,39],isLoading:!1,mainDialog:!1,confirmDialog:!1}},watch:{providerSelected:{handler:function(e,t){if(e)switch(this.WStoAdd=null,this.providerAccSelected=null,this.loadWSfromFitoagro(e.dataprovider_id),this.providerSelected.dataprovider_name){case"PESSL":this.needsAccount=!0,this.loadProviderAccounts(this.providerSelected.dataprovider_id),this.steps=[{title:"Fornecedor",rules:{provider:[e=>!!e||"Selecione um fornecedor"],proAcc:[e=>!!e||"Selecione uma conta"]},formValid:!1},{title:"Estações da Conta PESSL",formValid:!1},{title:"Estação a Adicionar",formValid:!1}];break;case"APAS":this.needsAccount=!0,this.loadProviderAccounts(this.providerSelected.dataprovider_id),this.steps=[{title:"Fornecedor",rules:{provider:[e=>!!e||"Selecione um fornecedor"],proAcc:[e=>!!e||"Selecione uma conta"]},formValid:!1},{title:"Estações da conta APAS disponíveis",formValid:!1},{title:"Estação a Adicionar",formValid:!1}];break;case"IPMA":this.needsAccount=!1,this.steps=[{title:"Fornecedor",rules:{provider:[e=>!!e||"Selecione um fornecedor"],proAcc:[e=>!!e||"Selecione uma conta"]},formValid:!1},{title:"Estações IPMA disponíveis",formValid:!1},{title:"Estação a Adicionar",formValid:!1}];break;case"WiseCrop":this.needsAccount=!0,this.loadProviderAccounts(this.providerSelected.dataprovider_id),this.steps=[{title:"Fornecedor",rules:{provider:[e=>!!e||"Selecione um fornecedor"],proAcc:[e=>!!e||"Selecione uma conta"]},formValid:!1},{title:"Estações da conta WiseCrop disponíveis",formValid:!1},{title:"Estação a Adicionar",formValid:!1}];break;case"TerraPro":this.needsAccount=!0,this.loadProviderAccounts(this.providerSelected.dataprovider_id),this.steps=[{title:"Fornecedor",rules:{provider:[e=>!!e||"Selecione um fornecedor"],proAcc:[e=>!!e||"Selecione uma conta"]},formValid:!1},{title:"Estações da conta TerraPro disponíveis",formValid:!1},{title:"Estação a Adicionar",formValid:!1}];break;default:this.steps=[{title:"Fornecedor",rules:{provider:[e=>!!e||"Selecione um fornecedor"],proAcc:[e=>!!e||"Selecione uma conta"]},formValid:!1},{title:"Estações do Fornecedor",formValid:!1},{title:"Estação a Adicionar",formValid:!1}]}},deep:!0},providerAccSelected:{handler:function(e,t){this.WStoAdd=null}}},computed:{selectItemsProvider(){return this.weatherStore.providersFromFitoagro.filter((e=>"ALL"!==e.dataprovider_name&&"SYSTEM"!==e.dataprovider_name))},providerIdSelected(){return this.providerSelected.dataprovider_id},providerNameSelected(){return this.providerSelected.dataprovider_name},lastStep(){return this.steps.length}},methods:{getMetadataByProvider(e){switch(e){case"IPMA":return{Timezone:"Europe/Lisbon","Daylight offset":0,"Standard offset":0};case"PESSL":return{Timezone:"Europe/Lisbon","Daylight offset":0,"Standard offset":0};case"APAS":return{Timezone:"Europe/Lisbon","Daylight offset":1,"Standard offset":0};case"WiseCrop":return{Timezone:"Europe/Lisbon","Daylight offset":1,"Standard offset":0};case"TerraPro":return{Timezone:"Europe/Lisbon","Daylight offset":-1,"Standard offset":0}}},postWStoFitoAgro(){this.isLoading=!0;let e={dataprovider_id:this.WStoAdd.dataprovider_id,datasource_externalid:this.WStoAdd.datasource_externalId,datasource_name:this.WStoAdd.datasource_name,datasource_location:{type:"Point",coordinates:this.WStoAdd.location},datasource_metadata:this.getMetadataByProvider(this.WStoAdd.dataprovider_name),datasource_properties:null,seriesvariables:this.WStoAdd.seriesvariables,datasourcetype_id:1};console.log(e),N.A.request({url:"api/dataproviders/"+this.WStoAdd.dataprovider_id+"/datasources",method:"post",headers:{Authorization:"Bearer "+this.accountStore.account.token},data:e}).then((e=>{this.mainDialog=!1,this.isLoading=!1,this.generalStore.successSnackbar("Estação adicionada com sucesso!"),this.$emit("updateWS")})).catch((e=>{console.log(e),this.generalStore.errorSnackbar("Erro ao adicionar estação!"),this.isLoading=!1}))},async loadWSfromFitoagro(e){N.A.request({url:"api/dataproviders/"+e+"/datasources",method:"get",params:{datasourcetype_id:1},headers:{Authorization:"Bearer "+this.accountStore.account.token}}).then((e=>{this.WSfromFitoagro={type:"FeatureCollection",features:e.data.datasources.map((e=>({type:"Feature",properties:{datasource_id:e.datasource_id,datasource_name:e.datasource_name,dataprovider_id:e.dataprovider_id,datasource_externalId:e.datasource_externalid},geometry:e.datasource_location})))},this.isLoading=!1})).catch((e=>{console.log(e)}))},async loadWSfromProvider(e){this.loadWSfromFitoagro(provider_Id),"IPMA"!=e?(this.needsAccount=!0,this.loadProviderAccounts(provider_Id)):this.needsAccount=!1},async loadProviderAccounts(e){this.loadingAccounts=!0,N.A.request({url:"api/providersaccounts",method:"get",headers:{Authorization:"Bearer "+this.accountStore.account.token},params:{dataprovider_id:e}}).then((e=>{this.providerAccounts=e.data.agents,this.loadingAccounts=!1})).catch((e=>{console.log(e)}))},valid(e){switch(e){case 1:return!this.steps.step1.formValid;case 2:return!this.steps.step2.formValid;case 3:return!this.steps.step3.formValid}},updateFormValid(e,t){this.steps[e].formValid=t},reset(){console.log("reset"),this.currStep=1,this.needsAccount=!1,this.loadingAccounts=!1,this.providerAccounts=[],this.providerSelected=null,this.providerAccSelected=null,this.WStoAdd=null,this.WSfromFitoagro={type:"FeatureCollection",features:[]},this.WSfromProvider={type:"FeatureCollection",features:[]}}}};const ia=(0,Q.A)(la,[["render",fe]]);var da=ia,sa={name:"WeatherStations",components:{WeatherStationsTable:G,WeatherStationsMap:re,AddWeatherStation:da},setup(){const e=(0,C.E)(),t=x(),a=1;return{accountStore:e,weatherStore:t,WSfromFitoagro_id:a}},data(){return{isLoading:!0,addWSdialog:!1,WSfromFitoagro:{type:"FeatureCollection",features:[]},WSfromIPMA:{type:"FeatureCollection",features:[]},providersfromFitoAgro:[{dataprovider_id:0,dataprovider_name:"ALL"}],filter:{provider_Id:null,datasource_name:null,datasource_externalId:null}}},methods:{stopLoading(){this.isLoading=!1},searchFitagro(){this.offset=0,this.getWSfromFitoagro()},async getProvidersfromFitoAgro(){this.isLoading=!0,N.A.request({url:"api/dataproviders",method:"get",headers:{Authorization:"Bearer "+this.accountStore.account.token}}).then((e=>{e.data.forEach((e=>{this.providersfromFitoAgro.push({dataprovider_id:e.dataprovider_id,dataprovider_name:e.dataprovider_name})})),this.weatherStore.providersFromFitoagro=this.providersfromFitoAgro})).catch((e=>{console.log(e)}))},async getWSfromFitoagro(){this.isLoading=!0;let e=void 0!=this.filter.provider_Id?this.filter.provider_Id:0;N.A.request({url:"api/dataproviders/"+e+"/datasources",method:"get",params:{datasourcetype_id:this.WSfromFitoagro_id,datasource_name:this.filter.datasource_name,datasource_externalid:this.filter.datasource_externalId},headers:{Authorization:"Bearer "+this.accountStore.account.token}}).then((e=>{this.WSfromFitoagro={type:"FeatureCollection",features:e.data.datasources.map((e=>({type:"Feature",properties:{datasource_id:e.datasource_id,datasourcetype_id:e.datasourcetype_id,datasource_name:e.datasource_name,dataprovider_id:e.dataprovider_id,datasource_externalId:e.datasource_externalid,datasource_properties:e.datasource_properties},geometry:e.datasource_location})))},this.weatherStore.WSfromFitoagro=this.WSfromFitoagro,this.offset+=this.limit,this.isLoading=!1,this.hasMore=e.data.hasMore})).catch((e=>{console.log(e)}))}},computed:{itemsToDisplay(){return this.WSfromFitoagro.features},tableItems(){return this.itemsToDisplay.map((e=>({datasource_id:e.properties.datasource_id,datasourcetype_id:e.properties.datasourcetype_id,datasource_name:e.properties.datasource_name,dataprovider_id:e.properties.dataprovider_id,dataprovider_name:this.providersfromFitoAgro.find((t=>t.dataprovider_id===e.properties.dataprovider_id)).dataprovider_name,datasource_externalId:e.properties.datasource_externalId,datasource_properties:e.properties.datasource_properties,location:e.geometry.coordinates})))},mapIcons(){let e=this.itemsToDisplay.map((e=>({type:"Feature",properties:{datasource_id:e.properties.datasource_id,datasource_name:e.properties.datasource_name,dataprovider_id:e.properties.dataprovider_id,dataprovider_name:this.providersfromFitoAgro.find((t=>t.dataprovider_id===e.properties.dataprovider_id)).dataprovider_name,datasource_externalId:e.properties.datasource_externalId},geometry:e.geometry})));return{type:"FeatureCollection",features:e}},filterSelectItems(){return this.providersfromFitoAgro.filter((e=>"ALL"!==e.dataprovider_name&&"SYSTEM"!==e.dataprovider_name))}},watch:{},mounted(){this.isLoading=!0,this.getProvidersfromFitoAgro().then((()=>{this.getWSfromFitoagro()}))},unmounted(){this.isLoading=!0}};const na=(0,Q.A)(sa,[["render",f]]);var ca=na},266:function(e,t,a){a.d(t,{l:function(){return I}});var o=a(6768),r=a(2586);const l=(0,r.G)("v-alert-title");var i=a(2807),d=a(7852),s=a(9669),n=a(2886),c=a(9262),u=a(2191),p=a(2542),m=a(7018),h=a(4581),v=a(5296),f=a(9788),S=a(8184),b=a(2067),_=a(3240),g=a(4663),k=a(7664),W=a(2428),y=a(144),F=a(4587),A=a(1247);const L=["success","info","warning","error"],V=(0,F.j)({border:{type:[Boolean,String],validator:e=>"boolean"===typeof e||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:h.TX,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>L.includes(e)},...(0,c.u)(),...(0,u.r)(),...(0,p.X)(),...(0,m.s)(),...(0,f.M)(),...(0,S.S)(),...(0,_.S)(),...(0,g.X)(),...(0,k.yx)(),...(0,W.gI)({variant:"flat"})},"VAlert"),I=(0,A.RW)()({name:"VAlert",props:V(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{emit:a,slots:r}=t;const c=(0,b.q)(e,"modelValue"),h=(0,o.EW)((()=>{if(!1!==e.icon)return e.type?e.icon??`$${e.type}`:e.icon})),g=(0,o.EW)((()=>({color:e.color??e.type,variant:e.variant}))),{themeClasses:F}=(0,k.NX)(e),{colorClasses:A,colorStyles:L,variantClasses:V}=(0,W.rn)(g),{densityClasses:I}=(0,u.Q)(e),{dimensionStyles:x}=(0,p.S)(e),{elevationClasses:w}=(0,m.j)(e),{locationStyles:C}=(0,f.z)(e),{positionClasses:E}=(0,S.J)(e),{roundedClasses:M}=(0,_.v)(e),{textColorClasses:T,textColorStyles:D}=(0,n.aH)((0,y.lW)(e,"borderColor")),{t:P}=(0,v.Ym)(),B=(0,o.EW)((()=>({"aria-label":P(e.closeLabel),onClick(e){c.value=!1,a("click:close",e)}})));return()=>{const t=!(!r.prepend&&!h.value),a=!(!r.title&&!e.title),n=!(!r.close&&!e.closable);return c.value&&(0,o.bF)(e.tag,{class:["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${!0===e.border?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},F.value,A.value,I.value,w.value,E.value,M.value,V.value,e.class],style:[L.value,x.value,C.value,e.style],role:"alert"},{default:()=>[(0,W.wN)(!1,"v-alert"),e.border&&(0,o.bF)("div",{key:"border",class:["v-alert__border",T.value],style:D.value},null),t&&(0,o.bF)("div",{key:"prepend",class:"v-alert__prepend"},[r.prepend?(0,o.bF)(d.K,{key:"prepend-defaults",disabled:!h.value,defaults:{VIcon:{density:e.density,icon:h.value,size:e.prominent?44:28}}},r.prepend):(0,o.bF)(s.w,{key:"prepend-icon",density:e.density,icon:h.value,size:e.prominent?44:28},null)]),(0,o.bF)("div",{class:"v-alert__content"},[a&&(0,o.bF)(l,{key:"title"},{default:()=>[r.title?.()??e.title]}),r.text?.()??e.text,r.default?.()]),r.append&&(0,o.bF)("div",{key:"append",class:"v-alert__append"},[r.append()]),n&&(0,o.bF)("div",{key:"close",class:"v-alert__close"},[r.close?(0,o.bF)(d.K,{key:"close-defaults",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>[r.close?.({props:B.value})]}):(0,o.bF)(i.D,(0,o.v6)({key:"close-btn",icon:e.closeIcon,size:"x-small",variant:"text"},B.value),null)])]})}}})},54:function(e,t,a){a.d(t,{gW:function(){return j}});var o=a(6768);const r=Symbol.for("vuetify:v-stepper");var l=a(2807),i=a(7852),d=a(5296),s=a(4587),n=a(1247),c=a(4600);const u=(0,s.j)({color:String,disabled:{type:[Boolean,String],default:!1},prevText:{type:String,default:"$vuetify.stepper.prev"},nextText:{type:String,default:"$vuetify.stepper.next"}},"VStepperActions"),p=(0,n.RW)()({name:"VStepperActions",props:u(),emits:{"click:prev":()=>!0,"click:next":()=>!0},setup(e,t){let{emit:a,slots:r}=t;const{t:s}=(0,d.Ym)();function n(){a("click:prev")}function u(){a("click:next")}return(0,c.C)((()=>{const t={onClick:n},a={onClick:u};return(0,o.bF)("div",{class:"v-stepper-actions"},[(0,o.bF)(i.K,{defaults:{VBtn:{disabled:["prev",!0].includes(e.disabled),text:s(e.prevText),variant:"text"}}},{default:()=>[r.prev?.({props:t})??(0,o.bF)(l.D,t,null)]}),(0,o.bF)(i.K,{defaults:{VBtn:{color:e.color,disabled:["next",!0].includes(e.disabled),text:s(e.nextText),variant:"tonal"}}},{default:()=>[r.next?.({props:a})??(0,o.bF)(l.D,a,null)]})])})),{}}});var m=a(2586);const h=(0,m.G)("v-stepper-header");var v=a(3416),f=a(9669),S=a(4690),b=a(2428),_=a(759);const g=(0,s.j)({color:String,title:String,subtitle:String,complete:Boolean,completeIcon:{type:String,default:"$complete"},editable:Boolean,editIcon:{type:String,default:"$edit"},error:Boolean,errorIcon:{type:String,default:"$error"},icon:String,ripple:{type:[Boolean,Object],default:!0},rules:{type:Array,default:()=>[]}},"StepperItem"),k=(0,s.j)({...g(),...(0,S.TX)()},"VStepperItem"),W=(0,n.RW)()({name:"VStepperItem",directives:{Ripple:_.n},props:k(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:a}=t;const l=(0,S.aO)(e,r,!0),i=(0,o.EW)((()=>l?.value.value??e.value)),d=(0,o.EW)((()=>e.rules.every((e=>!0===e())))),s=(0,o.EW)((()=>!e.disabled&&e.editable)),n=(0,o.EW)((()=>!e.disabled&&e.editable)),u=(0,o.EW)((()=>e.error||!d.value)),p=(0,o.EW)((()=>e.complete||e.rules.length>0&&d.value)),m=(0,o.EW)((()=>u.value?e.errorIcon:p.value?e.completeIcon:l.isSelected.value&&e.editable?e.editIcon:e.icon)),h=(0,o.EW)((()=>({canEdit:n.value,hasError:u.value,hasCompleted:p.value,title:e.title,subtitle:e.subtitle,step:i.value,value:e.value})));return(0,c.C)((()=>{const t=(!l||l.isSelected.value||p.value||n.value)&&!u.value&&!e.disabled,r=!(null==e.title&&!a.title),d=!(null==e.subtitle&&!a.subtitle);function c(){l?.toggle()}return(0,o.bo)((0,o.bF)("button",{class:["v-stepper-item",{"v-stepper-item--complete":p.value,"v-stepper-item--disabled":e.disabled,"v-stepper-item--error":u.value},l?.selectedClass.value],disabled:!e.editable,onClick:c},[s.value&&(0,b.wN)(!0,"v-stepper-item"),(0,o.bF)(v.y,{key:"stepper-avatar",class:"v-stepper-item__avatar",color:t?e.color:void 0,size:24},{default:()=>[a.icon?.(h.value)??(m.value?(0,o.bF)(f.w,{icon:m.value},null):i.value)]}),(0,o.bF)("div",{class:"v-stepper-item__content"},[r&&(0,o.bF)("div",{key:"title",class:"v-stepper-item__title"},[a.title?.(h.value)??e.title]),d&&(0,o.bF)("div",{key:"subtitle",class:"v-stepper-item__subtitle"},[a.subtitle?.(h.value)??e.subtitle]),a.default?.(h.value)])]),[[(0,o.gN)("ripple"),e.ripple&&e.editable,null]])})),{}}});var y=a(6048),F=a(2067),A=a(9094);const L=(0,s.j)({...(0,A.cJ)((0,y.ZJ)(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VStepperWindow"),V=(0,n.RW)()({name:"VStepperWindow",props:L(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:a}=t;const l=(0,o.WQ)(r,null),i=(0,F.q)(e,"modelValue"),d=(0,o.EW)({get(){return null==i.value&&l?l.items.value.find((e=>l.selected.value.includes(e.id)))?.value:i.value},set(e){i.value=e}});return(0,c.C)((()=>{const t=y.r3.filterProps(e);return(0,o.bF)(y.r3,(0,o.v6)({_as:"VStepperWindow"},t,{modelValue:d.value,"onUpdate:modelValue":e=>d.value=e,class:["v-stepper-window",e.class],style:e.style,mandatory:!1,touch:!1}),a)})),{}}});var I=a(1781);const x=(0,s.j)({...(0,I.w)()},"VStepperWindowItem"),w=(0,n.RW)()({name:"VStepperWindowItem",props:x(),setup(e,t){let{slots:a}=t;return(0,c.C)((()=>{const t=I.m.filterProps(e);return(0,o.bF)(I.m,(0,o.v6)({_as:"VStepperWindowItem"},t,{class:["v-stepper-window-item",e.class],style:e.style}),a)})),{}}});var C=a(7511),E=a(1146),M=a(2858),T=a(8353),D=a(144);const P=(0,s.j)({altLabels:Boolean,bgColor:String,completeIcon:String,editIcon:String,editable:Boolean,errorIcon:String,hideActions:Boolean,items:{type:Array,default:()=>[]},itemTitle:{type:String,default:"title"},itemValue:{type:String,default:"value"},nonLinear:Boolean,flat:Boolean,...(0,T.hx)()},"Stepper"),B=(0,s.j)({...P(),...(0,S.gL)({mandatory:"force",selectedClass:"v-stepper-item--selected"}),...(0,E.G)(),...(0,A.j6)(u(),["prevText","nextText"])},"VStepper"),j=(0,n.RW)()({name:"VStepper",props:B(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:a}=t;const{items:l,next:i,prev:d,selected:s}=(0,S.dB)(e,r),{displayClasses:n,mobile:u}=(0,T._F)(e),{completeIcon:m,editIcon:v,errorIcon:f,color:b,editable:_,prevText:g,nextText:k}=(0,D.QW)(e),y=(0,o.EW)((()=>e.items.map(((t,a)=>{const o=(0,A.TD)(t,e.itemTitle,t),r=(0,A.TD)(t,e.itemValue,a+1);return{title:o,value:r,raw:t}})))),F=(0,o.EW)((()=>l.value.findIndex((e=>s.value.includes(e.id))))),L=(0,o.EW)((()=>e.disabled?e.disabled:0===F.value?"prev":F.value===l.value.length-1&&"next"));return(0,M.Uh)({VStepperItem:{editable:_,errorIcon:f,completeIcon:m,editIcon:v,prevText:g,nextText:k},VStepperActions:{color:b,disabled:L,prevText:g,nextText:k}}),(0,c.C)((()=>{const t=E.i.filterProps(e),r=!(!a.header&&!e.items.length),l=e.items.length>0,s=!e.hideActions&&!(!l&&!a.actions);return(0,o.bF)(E.i,(0,o.v6)(t,{color:e.bgColor,class:["v-stepper",{"v-stepper--alt-labels":e.altLabels,"v-stepper--flat":e.flat,"v-stepper--non-linear":e.nonLinear,"v-stepper--mobile":u.value},n.value,e.class],style:e.style}),{default:()=>[r&&(0,o.bF)(h,{key:"stepper-header"},{default:()=>[y.value.map(((e,t)=>{let{raw:r,...l}=e;return(0,o.bF)(o.FK,null,[!!t&&(0,o.bF)(C.G,null,null),(0,o.bF)(W,l,{default:a[`header-item.${l.value}`]??a.header,icon:a.icon,title:a.title,subtitle:a.subtitle})])}))]}),l&&(0,o.bF)(V,{key:"stepper-window"},{default:()=>[y.value.map((e=>(0,o.bF)(w,{value:e.value},{default:()=>a[`item.${e.value}`]?.(e)??a.item?.(e)})))]}),a.default?.({prev:d,next:i}),s&&(a.actions?.({next:i,prev:d})??(0,o.bF)(p,{key:"stepper-actions","onClick:prev":d,"onClick:next":i},a))]})})),{prev:d,next:i}}})}}]);
//# sourceMappingURL=weather_stations.0e884057.js.map